<html>
<head>
  <title>Django</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1725"/>
<h1>Django</h1>

<div>
<span><div>创建Django项目</div><div>    django-admin startproject project_name    //创建django项目</div><div>    </div><div>    project_name</div><div>        - project_name        #对整个程序进行配置</div><div>            - init            </div><div>            - settings        #配置文件</div><div>            - url             #URL对应关系</div><div>            - wsgi            #遵循WSGI规范</div><div>        - manage.py           #管理Django程序：</div><div>                                    - python manage.py</div><div>                                    - python manage.py startapp xx</div><div>                                    - python manage.py makemigrations</div><div>                                    - python magage.py migrate</div><div>运行Django功能</div><div>    python manage.py runserver 127.0.0.1:8001</div><div><br/></div><div>创建app</div><div>    cd 工程名目录</div><div>    python manage.py startapp cmdb</div><div>    python manage.py startapp openstack</div><div><br/></div><div>app目录：</div><div>    migrations    数据修改表结构</div><div>    admin         Django为我们提供的后台管理</div><div>    apps          配置当前app</div><div>    models        ORM，写指定的类，通过命令就可以创建数据库结构</div><div>    tests         单元测试</div><div>    views         业务代码</div><div><br/></div><div>    project.settings.py</div><div>    1、配置模板路径</div><div>        TEMPLATES = [......]</div><div>    2、配置静态目录</div><div>        STATICFILES_DIRS = (......)</div><div><br/></div><div>定义路由规则</div><div>    url.py</div><div><span style="line-height: 1.45;">        &quot;login&quot;--&gt;函数名</span></div><div><br/></div><div>    name</div><div>        对URL路由关系进行命名，以后可以根据此名称生成自己想要的URL</div><div>        url(r'^abcdef/', views.index, name='indexx'),</div><div>        url(r'^abcdef/(\d+)\(\d+)/', views.index, name='indexx')</div><div>        模板语言：</div><div>        {% url 'indexx' %}</div><div>        {% url 'indexx' 3 %}</div><div>        注：</div><div>            #当前的URL</div><div>            request.path_info</div><div>定义视图函数</div><div>    request.GET</div><div>    request.POST</div><div>    request.FILES</div><div>    app下views.py</div><div>        def fuc(request):</div><div>            # request.method    GET/POST</div><div>            # request.POST.get('', None)</div><div><br/></div><div>            </div><div>            # return HttpResponse(&quot;字符串&quot;)</div><div>            # return render(request, &quot;HTML模板路径&quot;)</div><div>            # return redirect('只能填URL')</div><div><br/></div><div>模板渲染</div><div>    特殊的模板语言</div><div><br/></div><div>ORM操作</div><div>    创建类</div><div>    a.先写类</div><div>        from django.db import models</div><div>        class UserInfo(models.Model):</div><div>            username = models.CharField(max_length=32)</div><div>            password = models.CharField(max_length=64)</div><div>    b.注册APP</div><div>        INSTALLED_APPS = [</div><div><span style="line-height: 1.45;">            'django.contrib.admin',</span></div><div><span style="line-height: 1.45;">            'django.contrib.auth',</span></div><div><span style="line-height: 1.45;">            'django.contrib.contenttypes',</span></div><div><span style="line-height: 1.45;">            'django.contrib.sessions',</span></div><div><span style="line-height: 1.45;">            'django.contrib.messages',</span></div><div><span style="line-height: 1.45;">            'django.contrib.staticfiles',</span></div><div><span style="line-height: 1.45;">            'app01',</span></div><div><span style="line-height: 1.45;">        ]</span></div><div><span style="line-height: 1.45;">    c.执行命令</span></div><div>        python manage.py makemigrations</div><div>        python manage.py migrate</div><div>    d.注意</div><div>        django默认连接mysql的是MySQLdb模块，python3中没有该模块，so，采用pyMysql</div><div>        修改为pymysql：在project同名文件夹下的__init__文件中添加如下代码即可</div><div>            import pymysql</div><div>            pymysql.install_as_MySQLdb()</div><div>    1、根据类自动创建数据库表</div><div>        #app下的model.py</div><div>    </div><div>        字段：</div><div>            字符串类型</div><div>            数字</div><div>            时间</div><div>            二进制</div><div>            自增（primary_key=True）</div><div>        字段参数：</div><div>            null                -&gt;db是否可以为空</div><div>            default             -&gt;默认值</div><div>            primary_key         -&gt;主键</div><div>            db_column           -&gt;列名</div><div>            db_index            -&gt;索引</div><div>            unique              -&gt;唯一索引</div><div>            unique_for_date     </div><div>            unique_for_month</div><div>            unique_for_year</div><div>            choices             -&gt;django admin中显示下拉框，避免连表查询</div><div>            auto_now            -&gt;创建时，自动生成时间</div><div>            auto_now_add        -&gt;更新时，自动更新为当前时间</div><div>            blank               -&gt;django admin是否可以为空</div><div>            verbose_name        -&gt;django admin中显示字段中文</div><div>            editable            -&gt;django admin中是否可以被编辑</div><div>            error_messages      -&gt;</div><div>            help_text           -&gt;django admin中提示</div><div>            validators          -&gt;django admin中form自定义错误信息</div><div>    2、根据类对数据库表中的数据时行各种操作</div><div>        一对多：</div><div>            a.外键</div><div>            b.</div><div><br/></div><div>Templates</div><div>    模板继承</div><div>        extends</div><div>        include</div><div>        </div><div>        母板：{% block title %}{% endbolck %}</div><div>        子板：{% extends &quot;base.html&quot; %}</div><div>           {% block tile %}{% endblock %}</div><div>    自定义函数</div><div>        simple_tag</div><div>            a.app下创建templatetags目录</div><div>            b.任意xxoo.py文件</div><div>            c.创建template对象register</div><div>            d.@register.simple_tag</div><div>             def func(a1,a2,a3...)</div><div>                 return &quot;xxxx&quot;</div><div>            e.settings中注册APP</div><div>            f.顶部{% load xxoo %}</div><div>            g.{% 函数名 arg1 arg2 %}</div><div>            缺点：</div><div>                不能作为if条件</div><div>            优点：</div><div>                参数任意</div><div>        filter</div><div>            a.app下创建templatetags目录</div><div>            b.任意xxoo.py文件</div><div>              c.创建template对象register</div><div>            d.@register.filter</div><div>            def func(a1,a2)</div><div>                return &quot;xxxx&quot;</div><div>            e.settings中注册APP</div><div>            f.顶部{% load xxoo %}</div><div>            g.{{ 参数1|函数名:&quot;参数2&quot; }}</div><div>            缺点：</div><div>                参数最多两个，不能加空格</div><div>            优点：</div><div>                能作为if条件</div><div><br/></div><div>分页</div><div>cookie</div><div>    客户端浏览器上的一个文件</div><div><br/></div><div>    请求</div><div>    request.body</div><div>        request.POST(request.body)</div><div>        request.FILES(request.body)</div><div>        request.GET</div><div>        request.xxxx.getlist</div><div>    request.Meta(...)</div><div>        request.method(POST,GET,PUT)</div><div>        request.path_info</div><div>        request.COOKIES</div><div>session</div><div><span>    通用配置settings.py</span><br/></div><div><span><span>    </span><span>    SESSION_COOKIE_NAME = 'sessionid'<span>    </span><span>    </span><span>    </span><span>    #session的cookie保存在浏览器上时的key，即：sessionid=随机字符串（默认）</span></span><br/></span></div><div><span><span>    </span><span>    SESSION_COOKIE_PATH = '/'<span>    </span><span>    </span><span>    </span><span>    </span><span>    #session的cookie保存的路径（默认）</span></span><br/></span></div><div><span><span>    </span><span>    SESSION_COOKIE_DOMAIN = None<span>    </span><span>    </span><span>    </span><span>    </span><span>   #session的cookie保存的域名（默认）</span></span><br/></span></div><div><span>    </span><span>    SESSION_COOKIE_SECURE = False<span>    </span><span>    </span><span>    </span><span>    </span><span> #是否Https传输cookie（默认）</span></span></div><div><span><span>    </span><span>    SESSION_COOKIE_HTTPONLY = True<span>    </span><span>    </span><span>    </span><span>    </span><span>  #是否session的cookie只支持http传输（默认）</span></span><br/></span></div><div><span><span>    </span><span>    SESSION_COOKIE_AGE = 1209600<span>    </span><span>    </span><span>    </span><span>    </span><span>   #session的cookie的失效日期（默认2周）</span></span><br/></span></div><div><span>    </span><span>    SESSION_EXPIRE_AT_BROWSER_CLOSE = False<span>    </span><span>    </span><span>     #是否关闭浏览器使得session过期（默认）</span></span></div><div><span><span>    </span><span>    SESSION_SAVE_EVERY_REQUEST = False<span>    </span><span>    </span><span>    </span><span>    #是否每次请求都保存session，默认修改之后才保存（默认）</span></span><br/></span></div><div><br/></div></span>
</div></body></html> 