<html>
<head>
  <title>每天一个linux命令（48）：watch命令 - peida - 博客园</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1917"/>
<h1>每天一个linux命令（48）：watch命令 - peida - 博客园</h1>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><br/><div style="position: relative; max-width: 1067px;"><div style="font-size: 16px"><div style="font-family:Verdana, Arial, Helvetica, sans-serif;color:rgb(51, 51, 51);font-size:10pt;line-height:1.8;background:rgb(255, 255, 255);"><div><h1 style="margin:20px 0px 10px;padding:0px;font-weight:bold;color:rgb(0, 0, 0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221, 221, 221);font-size:14px;"><a href="http://www.cnblogs.com/peida/archive/2012/12/31/2840241.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(51, 51, 51);">每天一个linux命令（48）：watch命令</a></h1><div style="margin:0px;padding:0px;"><div style="margin:0px;padding:0px;margin-bottom:20px;"><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">watch是一个非常实用的命令，基本所有的Linux发行版都带有这个小工具，如同名字一样，watch可以帮你监测一个命令的运行结果，省得你一遍遍的手动运行。在Linux下，watch是周期性的执行下个程序，并全屏显示执行结果。</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">你可以拿他来监测你想要的一切命令的结果变化，比如 tail 一个 log 文件，ls 监测某个文件的大小变化，看你的想象力了</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">！</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">1．</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令格式：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">watch[参数][命令]</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">2．</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令功能：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">可以将命令的输出结果输出到标准输出设备，多用于周期性执行命令/定时执行命令</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">3．</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令参数：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;text-autospace:ideograph-other;line-height:15.7500pt;background:#ffffff;"><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">-</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;">n或--interval  watch缺省每2秒运行一下程序</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">，</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;">可以用-n或-interval来指定间隔的时间</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">。</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;text-autospace:ideograph-other;line-height:15.7500pt;background:#ffffff;"><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;">-d或--differences  用-d或--differences 选项watch 会高亮显示变化的区域</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">。</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;"> 而-d=cumulative选项会把变动过的地方(不管最近的那次有没有变动)都高亮显示出来</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">。</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;text-autospace:ideograph-other;line-height:15.7500pt;background:#ffffff;"><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;">-t 或-no-title  会关闭watch命令在顶部的时间间隔,命令</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">，</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:Tahoma;background-position:initial initial;background-repeat:initial initial;">当前时间的输出</span><span style="margin:0px;padding:0px;color:#454545;font-size:10.5pt;font-family:宋体;background-position:initial initial;background-repeat:initial initial;">。</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:0px;margin-bottom:0pt;"> <span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">-h, --help </span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">查看帮助文档</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">4．</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">使用实例：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实例</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">1：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">每隔一秒高亮显示</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">网络</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">链接数的变化情况</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">watch -n 1 -d netstat -ant</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">说明：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">其它操作：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">切换终端： Ctrl+x</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">退出watch：Ctrl+g</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实例</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">2：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'Times New Roman';">每隔一秒高亮显示http链接数的变化情况</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">watch -n 1 -d 'pstree|grep http'</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">说明：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">每隔一秒高亮显示http链接数的变化情况。 后面接的命令若带有管道符，需要加''将命令区域归整。</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实例</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">3：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实时查看模拟攻击客户机建立起来的连接数</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';">watch 'netstat -an | grep:21 | \ grep&lt;模拟攻击客户机的IP&gt;| wc -l' </span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">说明：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'Times New Roman';"><br style="margin:0px;padding:0px;"/></span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实例4：</span><span style="margin:0px;padding:0px;color:#35383d;font-weight:bold;font-size:10.5pt;font-family:Georgia;background-color:#ffffff;background-position:initial initial;background-repeat:initial initial;">监测</span><span style="margin:0px;padding:0px;color:#35383d;font-weight:bold;font-size:10.5pt;font-family:宋体;background-color:#ffffff;background-position:initial initial;background-repeat:initial initial;">当前目录中</span> <span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">scf'</span> <span style="margin:0px;padding:0px;color:#35383d;font-weight:bold;font-size:10.5pt;font-family:Georgia;background-color:#ffffff;background-position:initial initial;background-repeat:initial initial;">的文件</span><span style="margin:0px;padding:0px;color:#35383d;font-weight:bold;font-size:10.5pt;font-family:宋体;background-color:#ffffff;background-position:initial initial;background-repeat:initial initial;">的变化</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">watch -d 'ls -l|grep scf'</span> </p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-left:21.0000pt;margin-bottom:0pt;"></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">实例</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">5：</span><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">10秒一次输出系统的平均负载</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:21.0000pt;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-weight:bold;font-size:10.5000pt;font-family:'宋体';">命令：</span></p><p style="margin:10px auto;padding:0px;margin-top:0pt;text-indent:0px;margin-bottom:0pt;"><span style="margin:0px;padding:0px;mso-spacerun:'yes';font-size:10.5000pt;font-family:'宋体';">watch -n 10 'cat /proc/loadavg'</span></p></div><div style="margin:0px;padding:0px;display:block;"><p style="margin:0px;padding:0px;margin-top:12px;margin-bottom:0px;"><br/></p></div></div></div></div></div></div></span>
</div></body></html> 