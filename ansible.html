<html>
<head>
  <title>ansible</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="626"/>
<h1>ansible</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">ansible配置文件</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Ansible配置文件/etc/ansible/ansible.cfg（一般保持默认）</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">[defaults]
#inventory = /etc/ansible/hosts     #主机列表配置文件
#libary = /usr/share/my_modules/    #库文件存放目录
#remote_tmp = $HOME/.ansible/tmp    #临时py命令文件存放在远程主机目录
#local_tmp = $HOME/.ansible/tmp     #本机临时命令执行目录
#forks = 5      #默认并发数
#sudo_user = root       #默认sudo用户
#ask_sudo_pass = True       #每次执行ansible命令是否询问ssh密码
#ask_pass = True 
#remote_port = 22
#host_key_checking = False      #检查对应服务器的host_key，建议取消注释
#log_path = /var/log/ansible.log        #日志文件
</code></pre>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">ansible系列命令</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible系列命令</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ansible ansible-doc ansible-playbook ansible-vault ansible-console ansible-galaxy ansible-pull</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible-doc：显示模块帮助</h3>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible-doc [options] [module...]
-a              显示所有模块的文档
-l, --list      列出可用模块
-s, --snippet   显示指定模块的playbook片段

示例：
ansible-doc -l              #列出所有模块
ansible-doc ping          #查看指定模块帮助用法
ansible-doc -s ping      #查看指定模块帮助用法
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ansible通过ssh实现配置管理、应用部署、任务执行等功能，建议配置ansible端基于密钥认证的方式联系各被管理节点。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible &lt;host-pattern&gt; [-m module_name] [-a args]
--version                           显示版本
-m module                        指定模块，默认为command
-v  详细过程    -vv   -vvv  更详细
--list-hosts                        显示主机列表，可简写--list
-k, --ask-pass                    提示输入ssh连接密码，默认key验证
-K, --ask-become-pass        提示输入sudo时的口令
-C, --check                       检查，并不执行
-T, --timeout=TIMEOUT       执行命令的超时时间，默认10s
-u, --user=REMOTE_USER    执行远程执行的用户
-b, --become                    代替旧版的sudo切换
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible的Host-pattern</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">ansibler的Host-pattern</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">all    表示所有Inventory中的所有主机</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible all -m ping
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">通配符</li>
</ul>
</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible &quot;*&quot; -m ping
ansible 192.168.1.* -m ping
ansible &quot;*srvs&quot; -m ping
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">或关系</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible &quot;websrvs:appsrvs&quot; -m ping
ansible &quot;192.168.1.10:192.168.1.20&quot; -m ping
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">逻辑与</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible &quot;websrvs:&amp;dbsrvs&quot;  -m ping      在websrvs组并且在dbsrvs组中的主机
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">逻辑非</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible 'websrvs:!dbsrvs' -m ping       在websrvs组，但不在dbsrvs组中的主机
注意：此处为单引号
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">综合逻辑</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible 'websrvs:dbsrvs:&amp;appsrvs:!ftpsrvs' -m ping
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">正则表达式</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible &quot;websrvs:&amp;dbsrvs&quot; -m ping
ansible &quot;~(web|db).*\.magedu\.com&quot; -m ping
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible命令执行过程</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible命令执行过程
<ol style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">加载自己的配置文件默认/etc/ansible/ansible.cfg</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">加载自己对应的模块文件，如command</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">通过ansible将模块或命令生成对应的临时py文件，并将该文件传输至远程服务器的对应执行用户$HOME/.ansible/tmp/ansible-tmp-数字/xxx.py文件</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">给文件+x执行</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">执行并返回结果</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">删除临时py文件，sleep 0退出</li>
</ol>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">执行状态
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">绿色：执行成功并且不需要做改变的操作</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">黄色：执行成功并且对目标主机做变更</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">红色：执行失败</li>
</ul>
</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">ansible常用模块</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">command：在远程主机执行命令，默认模块，可忽略-m选项
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srvs -m command -a 'service vsftpd start'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srvs -m command -a 'echo magedu|passwd --stdin wang'    #这条命令不成功</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">此模块不支持$VARNAME&lt;&gt;|;&amp;等</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">shell：和command相似，用shell执行命令
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srvs -m shell -a 'echo magedu|passwd --stdin wang'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">调用bash执行命令类似cat /tmp/stanley.md|awk -F'|' '{print $1, $2}' &amp;&gt; /tmp/example.txt这些复杂命令，即使使用shell也可能会失败，解决办法：写到脚本时，copy到远程，执行再把需要的结果拉回执行命令的机器</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">script：运行脚本
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">-a &quot;/PATH/TO/SCRIPT_FILE&quot;</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible websrvs -m script -a f1.sh</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">copy：从服务器复制文件到客户端
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m copy -a &quot;src=/root/f1.sh dest=/tmp/f2.sh owner=wang mode=600 backup=yes&quot;    #如果目标存在，默认覆盖，此处指定先备份</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible src -m copy -a &quot;content='test content\n' dest=/tmp/f1.txt&quot;    #利用内容，直接生成目标文件</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">fetch：从客户端取文件至服务端，copy相反，目录可先tar
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m fetch -a 'src=/root/a.sh dest=/data/scripts'</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">file：设置文件属性
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m file -a &quot;path=/root/a.sh owner=wang mode=755&quot;</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible web -m file -a &quot;src=/app/testfile dest=/app/testfile-link state=link&quot;</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">service：管理服务
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m service -a 'name=httpd state=stopped'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m service -a 'name=httpd state=started'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m service -a 'name=httpd state=reloaded'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m service -a 'name=httpd state=restarted'</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">user：管理用户
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m user -a 'name=user1 comment=&quot;test user&quot; uid=2048 home=/app/user1 group=root'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m user -a 'name=sysuser1 system=yes home=/app/sysuser1'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m user -a 'name=user1 state=absent remove=yes'    #删除用户及家目录等数据</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">group：管理组
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m group -a 'name=testgroup system=yes'</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m group -a 'name=testgroup state=absent'</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">hostname：管理主机名
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible node1 -m hostname -a 'name=websrv'</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">cron：计划任务，支持时间：minute, hour, day, month, weekday
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m cron -a &quot;minute=*/5 job='/usr/sbin/ntpdate 172.16.0.1 &amp;&gt;/dev/null' name=Synctime&quot;    #创建任务</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m cron -a 'state=absent name=Synctime'    #删除任务</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">yum：管理包
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m yum -a 'name=httpd state=latest'    #安装</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible srv -m yum -a 'name=httpd state=absent'    #删除</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-galaxy
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">连接https://galaxy.ansible.com下载相应的roles</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">列出所有已安装的galaxy<br/>
ansible-galaxy list</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">安装galaxy<br/>
ansible-galaxy install geerlingguy.redis</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">删除galaxy<br/>
ansible-galaxy remove geerlingguy.redis</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-pull<br/>
推送命令至远程，效率无限提升，对运维要求高</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-playbook<br/>
ansible-playbook hello.yml</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">cat hello.yml
#hello world yml file
- hosts: websrvs
  remote_user: root
  tasks:
    - name: hello world
      command: /usr/bin/wall hello world
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">功能：管理加密解密yml文件</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault [create|decrypt|edit|encrypt|rekey|view]</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault encrypt hello.yml    加密</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault decrypt hello.yml    解密</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault view hello.yml        查看</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault edit hello.yml        编辑加密文件</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault rekey hello.yml      修改口令</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-vault create new.yml      创建新文件</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible-console：2.0+新增，可交互执行命令，支持tab
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">root@test(2)[f:10]$</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">设置并发数：fork n 例如：forks 10</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">切换组：cd 主机组 例如：cd web</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">列出当前组主机列表：list</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">列出所有的内置命令：?或help</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">示例：<br/>
<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">root@all(2)[f:5]$ list root@all(2)[f:5]$ cd appsrvs root@appsrvs(2)[f:5]$ list root@appsrvs(2)[f:5]$ yum name=httpd state=present root@appsrvs(2)[f:5]$ service name=httpd state=started</code></li>
</ul>
</li>
</ul>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">playbook</h2>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">playbook是由一个或多个&quot;play&quot;组成的列表</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">play的主要功能在于将事先归并为一组的主机装扮成事先通过ansible中的task定义好的角色。从根本上来讲，所谓task无非是调用ansible的一个module。将多个play组织在一个playbook中，即可以让它们联同起来按事先编排的机制同唱一台大戏</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">playbook采用YAML语言编写</li>
</ul>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">YAML语法简介</h2>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">在单一档案中，可用连续三个连字号(---)区分多个档案。另外，还有选择性的连续三个点号(...)用来表示档案结尾</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">次行开始正常写playbook的内容，一般建议写明该playbook的功能</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">使用#号注释代码</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">缩进必须是统一的，不能空格和tab混用</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">缩进的级别也必须是一致的，同样的缩进代表同样的级别，程序判别配置的级别是通过缩进结合换行来实现的</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">YAML文件内容和Linux系统大小写判断方式保持一致，是区别大小写的，k/v的值均需大小写敏感</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">k/v的值可同行写也可换行写。同行使用:分隔</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">v可是个字符串，也可是另一个列表</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">一个完整的代码块功能需要最少元素包括name: task</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">一个name只能包括一个task</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">YAML文件扩展名通常为yml或yaml</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">list：列表，其所有元素均使用&quot;-&quot;打头</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">示例：
#a list of tasty fruits
- app
- orange
- strawberry
- mango
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">dictionary：字典，通常由多个key与value构成</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">示例：
#an employee record
name: example developer
job: developer
skill: elite

也可以将key:value放置于{}中进行表示，用&quot;,&quot;分隔多个key:value
示例：
#an employee record
{name: example developer, job:developer, skill:elite}
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">YAML的语法和其他高阶语言类似，并且可以简单表达清单、散列表、标题等数据结构。其结构（structure）通过空格来展示，序列（sequence）里的项用&quot;-&quot;来代表，map里的键值对用&quot;:&quot;分隔</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">示例：
name: John Smith
age: 41
gender: Male
spouse:
  name: Jane Smith
  age: 37
  gender: Female
children:
- name: Jimmy Smith
  age: 17
  gender: Male
- name: jenny Smith
  age: 13
  fender: Female
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">playbook核心元素</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">hosts                执行的远程主机列表</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">tasks                任务集</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">varniables         内置变量或自定义变量在playbook中调用</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">templates         模板，可替换模板文件中的变量并实现一些简单逻辑文件</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">handlers           和notify结合使用，由特定条件触发操作，满足条件主才执行，否则不执行</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">tags                标签，指定某条任务执行，用于选择运行playbook中的部分代码。ansible具有幂等性，因此会自动跳过没有变化的部分，即便如此，有些代码为测试其确实没有发生变化的时间依然会非常的长。此时，如果确信没有变化，就可以通过tags跳过那些代码片断，ansible-playbook -t tagsname useradd.yml</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">playbook基础组件</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">remote_user     可用于host和task中。也可以通过指定其通过sudo的方式在远程主机上执行任务，其可用于play全局或某任务；此外，甚至可以在sudo时使用sudo_user指定sudo时切换的用户</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">- host: websrvs
  remote_user: root
  tasks:
  - name: test connection
    ping:
    remote_user: magedu
    sudo: yes
    sudo_user: wang
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">hosts
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">playbook中的每一个play的目的都是为了让某个或某些主机以某个指定的用户身份执行任务。hosts用于指定要执行指定任务的主机，须事先定义在主机清单中</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">可以是如下形式：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"> one.example.com
one.example.com:two.example.com
192.168.1.50
192.168.1.*
</code></pre>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">websrvs:dbsrvs        两个组的并集</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">websrvs:&amp;dbsrvs      两个组的交集</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">websrvs:!phoenix     在websrvs组，但不在dbsrvs组</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">示例：
- hosts: websrvs:dbsrvs
</code></pre>
</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">task列表和action
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">play的主体部分是task list。task list中的各任务按次序逐个在hosts中指定的所有主机上执行，即在所有主机上完成第一个任务后再开始第二个。在运行自上而下某playbook时，如果中途发生错误，所有已执行任务都将回滚，因此，在更正playbook后重新执行一次即可</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">task的目的是使用指定的参数执行模块，而在模块参数中可以使用变量。模块执行是幂等的，这意味着多次执行是安全的，因为其结果均一致</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">每个task都应该有其name，用于playbook的执行结果输出，建议其内容尽可能清晰描述任务执行步骤。如果未提供name，则action的结果将用于输出</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">task：任务列表</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">格式：(1) action: module arguments<br/>
(2) module: arguments<br/>
注意：shell和command模块后面跟命令，而非key=value</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">某任务的状态在运行后为changed时，可通过&quot;notify&quot;通知给相应的handlers</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">任务可以通过&quot;tags&quot;打标签，而后可在ansible-playbook命令上使用-t指定进行调用</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">示例：
task:
  - name: disabled selinux
    command: /sbin/setenforce 0
</code></pre>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">如果命令或脚本的退出码不为零，可以使用如下方式替代</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">tasks:
  - name: run this command and ignore the result
    shell: /usr/bin/somecommad || /bin/true
</code></pre>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">或者使用ignore_errors来忽略错误信息</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">tasks:
  - name: run this command and ignore the result
   shell: /usr/bin/somecommand
   ignore_errors: true
</code></pre>
</li>
</ul>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">handlers和notify结合使用触发条件
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">handlers，是task列表，这些task与前述的task并没有本质上的不同，用于当关注的资源发生变化时，才会采取一定的操作。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">notify此action可用于每个play的最后被触发，这样可避免多次有改变发生时每次都执行指定的操作，仅在所有的变化发生完成后一次性地执行指定操作。在notify中列出的操作称为handler，也即notify中调用handler中定义的操作。</li>
</ul>
</li>
</ul>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">playbook中变量使用</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">变量名：仅能由字母、数字和下划线组成，且只能以字母开头</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">变量来源：
<ol style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">ansible setup facts 远程主机的所有变量都可直接调用</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">在/etc/ansible/hosts中定义<br/>
普通变量：主机组中主机单独定义，优先级高于公共变量<br/>
公共（组）变量：针对主机组中所有主机定义统一变量</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">通过命令行指定变量，优先级最高<br/>
ansible-playbook -e varname=value</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">在playbook中定义</li>
</ol>
</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">    vars:
      - var1: value1
      - var2: value2
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">5. 在独立的变量YAML文件中定义<br/>
6. 在role中定义</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">模板templates</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">文本文件，嵌套有脚本（使用模板编程语言编写）</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">jinja2语言，使用字面量，有下面形式<br/>
字符串：使用单引号或双引号<br/>
数字：整数，浮点数<br/>
列表：[item1, item2, ...]<br/>
元组：(item1, item2, ...)<br/>
字典：{key1:value1, key2:value2, ...}<br/>
布尔型：true/false</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">算术运算：+, -, *, /, //, **</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">比较操作：==, !=, &gt;, &gt;=, &lt;, &lt;=</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">逻辑运算：and, or, not</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">流表达式：for if when</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">templates功能：根据模块文件动态生成对应的配置文件
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">templates文件必须存放于templates目录下，且命名为.j2结尾</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">yaml/yml文件需要和templates目录平级，目录结构如下：<br/>
./<br/>
|---temnginx.yml<br/>
|---templates<br/>
|---nginx.conf.j2</li>
</ul>
</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">when</h4>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">条件测试：如果需要根据变量、facts或此前任务的执行结果来做为某task执行与否的前提时要用到条件测试，通过when语句实现，在task中使用，jinja2的语法格式</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">when语句</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">在task后添加when子句即可使用条件测试；when语句支持jinja2表达式语法</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">示例：</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">tasks:
- name: &quot;shutdown RedHat flavored systems&quot;
  command: /sbin/shutdown -h now
  when: ansible_os_family == &quot;RedHat&quot;
</code></pre>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">with_items</h4>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">迭代：当有需要重复性执行的任务时，可以使用迭代机制
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对迭代项的引用，固定变量名为“item”</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">要在task中使用with_items给定要迭代的元素列表</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">列表格式：<br/>
字符串<br/>
字典</li>
</ul>
</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">for if</h4>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">{% for vhost in nginx_vhosts %}
server {
    listen {{ vhost.listen | default('80 default_server') }};
    
    {% if vhost.server_name is defined %}
    server_name {{ vhost.server_name }};
    {% endif %}
    
    {% if vhost.root is defined %}
    root {{ vhost.root }};
    {% endif %}
}
{% endfor %}
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">运行playbook</h3>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">运行playbook方式</li>
</ul>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">ansible-playbook &lt;filename.yml&gt; ... [options]
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">常见选项<br/>
--check        只检测可能会发生的改变，但不真正执行操作<br/>
--list-hosts   列出运行任务的主机<br/>
--limit 主机列表    只针对主机列表中的主机执行<br/>
-v    显示过程    -vv -vvv    更详细</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">示例<br/>
ansible-playbook file.yml --check<br/>
ansible-playbook file.yml<br/>
ansible-playbook file.yml --limit websrvs</li>
</ul>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%20ansible%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%0AAnsible%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%2Fetc%2Fansible%2Fansible.cfg%EF%BC%88%E4%B8%80%E8%88%AC%E4%BF%9D%E6%8C%81%E9%BB%98%E8%AE%A4%EF%BC%89%0A%60%60%60%0A%5Bdefaults%5D%0A%23inventory%20%3D%20%2Fetc%2Fansible%2Fhosts%20%20%20%20%20%23%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%0A%23libary%20%3D%20%2Fusr%2Fshare%2Fmy_modules%2F%20%20%20%20%23%E5%BA%93%E6%96%87%E4%BB%B6%E5%AD%98%E6%94%BE%E7%9B%AE%E5%BD%95%0A%23remote_tmp%20%3D%20%24HOME%2F.ansible%2Ftmp%20%20%20%20%23%E4%B8%B4%E6%97%B6py%E5%91%BD%E4%BB%A4%E6%96%87%E4%BB%B6%E5%AD%98%E6%94%BE%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95%0A%23local_tmp%20%3D%20%24HOME%2F.ansible%2Ftmp%20%20%20%20%20%23%E6%9C%AC%E6%9C%BA%E4%B8%B4%E6%97%B6%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9B%AE%E5%BD%95%0A%23forks%20%3D%205%20%20%20%20%20%20%23%E9%BB%98%E8%AE%A4%E5%B9%B6%E5%8F%91%E6%95%B0%0A%23sudo_user%20%3D%20root%20%20%20%20%20%20%20%23%E9%BB%98%E8%AE%A4sudo%E7%94%A8%E6%88%B7%0A%23ask_sudo_pass%20%3D%20True%20%20%20%20%20%20%20%23%E6%AF%8F%E6%AC%A1%E6%89%A7%E8%A1%8Cansible%E5%91%BD%E4%BB%A4%E6%98%AF%E5%90%A6%E8%AF%A2%E9%97%AEssh%E5%AF%86%E7%A0%81%0A%23ask_pass%20%3D%20True%20%0A%23remote_port%20%3D%2022%0A%23host_key_checking%20%3D%20False%20%20%20%20%20%20%23%E6%A3%80%E6%9F%A5%E5%AF%B9%E5%BA%94%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84host_key%EF%BC%8C%E5%BB%BA%E8%AE%AE%E5%8F%96%E6%B6%88%E6%B3%A8%E9%87%8A%0A%23log_path%20%3D%20%2Fvar%2Flog%2Fansible.log%20%20%20%20%20%20%20%20%23%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%0A%60%60%60%0A%23%23%20ansible%E7%B3%BB%E5%88%97%E5%91%BD%E4%BB%A4%0A%23%23%23%20ansible%E7%B3%BB%E5%88%97%E5%91%BD%E4%BB%A4%0Aansible%20ansible-doc%20ansible-playbook%20ansible-vault%20ansible-console%20ansible-galaxy%20ansible-pull%0A%23%23%23%20ansible-doc%EF%BC%9A%E6%98%BE%E7%A4%BA%E6%A8%A1%E5%9D%97%E5%B8%AE%E5%8A%A9%0A%60%60%60%0Aansible-doc%20%5Boptions%5D%20%5Bmodule...%5D%0A-a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%E7%9A%84%E6%96%87%E6%A1%A3%0A-l%2C%20--list%20%20%20%20%20%20%E5%88%97%E5%87%BA%E5%8F%AF%E7%94%A8%E6%A8%A1%E5%9D%97%0A-s%2C%20--snippet%20%20%20%E6%98%BE%E7%A4%BA%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97%E7%9A%84playbook%E7%89%87%E6%AE%B5%0A%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0Aansible-doc%20-l%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%0Aansible-doc%20ping%20%20%20%20%20%20%20%20%20%20%23%E6%9F%A5%E7%9C%8B%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97%E5%B8%AE%E5%8A%A9%E7%94%A8%E6%B3%95%0Aansible-doc%20-s%20ping%20%20%20%20%20%20%23%E6%9F%A5%E7%9C%8B%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97%E5%B8%AE%E5%8A%A9%E7%94%A8%E6%B3%95%0A%60%60%60%0A%0A%23%23%23%20ansible%0Aansible%E9%80%9A%E8%BF%87ssh%E5%AE%9E%E7%8E%B0%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E3%80%81%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%E3%80%81%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E7%AD%89%E5%8A%9F%E8%83%BD%EF%BC%8C%E5%BB%BA%E8%AE%AE%E9%85%8D%E7%BD%AEansible%E7%AB%AF%E5%9F%BA%E4%BA%8E%E5%AF%86%E9%92%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E6%96%B9%E5%BC%8F%E8%81%94%E7%B3%BB%E5%90%84%E8%A2%AB%E7%AE%A1%E7%90%86%E8%8A%82%E7%82%B9%E3%80%82%0A%60%60%60%0Aansible%20%3Chost-pattern%3E%20%5B-m%20module_name%5D%20%5B-a%20args%5D%0A--version%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%98%BE%E7%A4%BA%E7%89%88%E6%9C%AC%0A-m%20module%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97%EF%BC%8C%E9%BB%98%E8%AE%A4%E4%B8%BAcommand%0A-v%20%20%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B%20%20%20%20-vv%20%20%20-vvv%20%20%E6%9B%B4%E8%AF%A6%E7%BB%86%0A--list-hosts%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%98%BE%E7%A4%BA%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%EF%BC%8C%E5%8F%AF%E7%AE%80%E5%86%99--list%0A-k%2C%20--ask-pass%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%8F%90%E7%A4%BA%E8%BE%93%E5%85%A5ssh%E8%BF%9E%E6%8E%A5%E5%AF%86%E7%A0%81%EF%BC%8C%E9%BB%98%E8%AE%A4key%E9%AA%8C%E8%AF%81%0A-K%2C%20--ask-become-pass%20%20%20%20%20%20%20%20%E6%8F%90%E7%A4%BA%E8%BE%93%E5%85%A5sudo%E6%97%B6%E7%9A%84%E5%8F%A3%E4%BB%A4%0A-C%2C%20--check%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%A3%80%E6%9F%A5%EF%BC%8C%E5%B9%B6%E4%B8%8D%E6%89%A7%E8%A1%8C%0A-T%2C%20--timeout%3DTIMEOUT%20%20%20%20%20%20%20%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4%EF%BC%8C%E9%BB%98%E8%AE%A410s%0A-u%2C%20--user%3DREMOTE_USER%20%20%20%20%E6%89%A7%E8%A1%8C%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%9A%84%E7%94%A8%E6%88%B7%0A-b%2C%20--become%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E4%BB%A3%E6%9B%BF%E6%97%A7%E7%89%88%E7%9A%84sudo%E5%88%87%E6%8D%A2%0A%60%60%60%0A%0A%23%23%23%20ansible%E7%9A%84Host-pattern%0Aansibler%E7%9A%84Host-pattern%0A*%20all%20%20%20%20%E8%A1%A8%E7%A4%BA%E6%89%80%E6%9C%89Inventory%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E4%B8%BB%E6%9C%BA%0A%60%60%60%0Aansible%20all%20-m%20ping%0A%60%60%60%0A*%20*%20%20%20%20%20%20%E9%80%9A%E9%85%8D%E7%AC%A6%0A%60%60%60%0Aansible%20%22*%22%20-m%20ping%0Aansible%20192.168.1.*%20-m%20ping%0Aansible%20%22*srvs%22%20-m%20ping%0A%60%60%60%0A*%20%E6%88%96%E5%85%B3%E7%B3%BB%0A%60%60%60%0Aansible%20%22websrvs%3Aappsrvs%22%20-m%20ping%0Aansible%20%22192.168.1.10%3A192.168.1.20%22%20-m%20ping%0A%60%60%60%0A*%20%E9%80%BB%E8%BE%91%E4%B8%8E%0A%60%60%60%0Aansible%20%22websrvs%3A%26dbsrvs%22%20%20-m%20ping%20%20%20%20%20%20%E5%9C%A8websrvs%E7%BB%84%E5%B9%B6%E4%B8%94%E5%9C%A8dbsrvs%E7%BB%84%E4%B8%AD%E7%9A%84%E4%B8%BB%E6%9C%BA%0A%60%60%60%0A*%20%E9%80%BB%E8%BE%91%E9%9D%9E%0A%60%60%60%0Aansible%20'websrvs%3A!dbsrvs'%20-m%20ping%20%20%20%20%20%20%20%E5%9C%A8websrvs%E7%BB%84%EF%BC%8C%E4%BD%86%E4%B8%8D%E5%9C%A8dbsrvs%E7%BB%84%E4%B8%AD%E7%9A%84%E4%B8%BB%E6%9C%BA%0A%E6%B3%A8%E6%84%8F%EF%BC%9A%E6%AD%A4%E5%A4%84%E4%B8%BA%E5%8D%95%E5%BC%95%E5%8F%B7%0A%60%60%60%0A*%20%E7%BB%BC%E5%90%88%E9%80%BB%E8%BE%91%0A%60%60%60%0Aansible%20'websrvs%3Adbsrvs%3A%26appsrvs%3A!ftpsrvs'%20-m%20ping%0A%60%60%60%0A*%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%0A%60%60%60%0Aansible%20%22websrvs%3A%26dbsrvs%22%20-m%20ping%0Aansible%20%22~(web%7Cdb).*%5C.magedu%5C.com%22%20-m%20ping%0A%60%60%60%0A%0A%23%23%23%20ansible%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%0A*%20ansible%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%0A%20%20%20%201.%20%E5%8A%A0%E8%BD%BD%E8%87%AA%E5%B7%B1%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%2Fetc%2Fansible%2Fansible.cfg%0A%20%20%20%202.%20%E5%8A%A0%E8%BD%BD%E8%87%AA%E5%B7%B1%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A8%A1%E5%9D%97%E6%96%87%E4%BB%B6%EF%BC%8C%E5%A6%82command%0A%20%20%20%203.%20%E9%80%9A%E8%BF%87ansible%E5%B0%86%E6%A8%A1%E5%9D%97%E6%88%96%E5%91%BD%E4%BB%A4%E7%94%9F%E6%88%90%E5%AF%B9%E5%BA%94%E7%9A%84%E4%B8%B4%E6%97%B6py%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B9%B6%E5%B0%86%E8%AF%A5%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E8%87%B3%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%AF%B9%E5%BA%94%E6%89%A7%E8%A1%8C%E7%94%A8%E6%88%B7%24HOME%2F.ansible%2Ftmp%2Fansible-tmp-%E6%95%B0%E5%AD%97%2Fxxx.py%E6%96%87%E4%BB%B6%0A%20%20%20%204.%20%E7%BB%99%E6%96%87%E4%BB%B6%2Bx%E6%89%A7%E8%A1%8C%0A%20%20%20%205.%20%E6%89%A7%E8%A1%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%0A%20%20%20%206.%20%E5%88%A0%E9%99%A4%E4%B8%B4%E6%97%B6py%E6%96%87%E4%BB%B6%EF%BC%8Csleep%200%E9%80%80%E5%87%BA%0A*%20%E6%89%A7%E8%A1%8C%E7%8A%B6%E6%80%81%0A%20%20%20%20-%20%E7%BB%BF%E8%89%B2%EF%BC%9A%E6%89%A7%E8%A1%8C%E6%88%90%E5%8A%9F%E5%B9%B6%E4%B8%94%E4%B8%8D%E9%9C%80%E8%A6%81%E5%81%9A%E6%94%B9%E5%8F%98%E7%9A%84%E6%93%8D%E4%BD%9C%0A%20%20%20%20-%20%E9%BB%84%E8%89%B2%EF%BC%9A%E6%89%A7%E8%A1%8C%E6%88%90%E5%8A%9F%E5%B9%B6%E4%B8%94%E5%AF%B9%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA%E5%81%9A%E5%8F%98%E6%9B%B4%0A%20%20%20%20-%20%E7%BA%A2%E8%89%B2%EF%BC%9A%E6%89%A7%E8%A1%8C%E5%A4%B1%E8%B4%A5%0A%0A%23%23%23%20ansible%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%0A*%20command%EF%BC%9A%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E9%BB%98%E8%AE%A4%E6%A8%A1%E5%9D%97%EF%BC%8C%E5%8F%AF%E5%BF%BD%E7%95%A5-m%E9%80%89%E9%A1%B9%0A%20%20%20%20-%20ansible%20srvs%20-m%20command%20-a%20'service%20vsftpd%20start'%0A%20%20%20%20-%20ansible%20srvs%20-m%20command%20-a%20'echo%20magedu%7Cpasswd%20--stdin%20wang'%20%20%20%20%23%E8%BF%99%E6%9D%A1%E5%91%BD%E4%BB%A4%E4%B8%8D%E6%88%90%E5%8A%9F%0A%20%20%20%20-%20%E6%AD%A4%E6%A8%A1%E5%9D%97%E4%B8%8D%E6%94%AF%E6%8C%81%24VARNAME%3C%3E%7C%3B%26%E7%AD%89%0A*%20shell%EF%BC%9A%E5%92%8Ccommand%E7%9B%B8%E4%BC%BC%EF%BC%8C%E7%94%A8shell%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%0A%20%20%20%20-%20ansible%20srvs%20-m%20shell%20-a%20'echo%20magedu%7Cpasswd%20--stdin%20wang'%0A%20%20%20%20-%20%E8%B0%83%E7%94%A8bash%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%B1%BB%E4%BC%BCcat%20%2Ftmp%2Fstanley.md%7Cawk%20-F'%7C'%20'%7Bprint%20%241%2C%20%242%7D'%20%26%3E%20%2Ftmp%2Fexample.txt%E8%BF%99%E4%BA%9B%E5%A4%8D%E6%9D%82%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%8D%B3%E4%BD%BF%E4%BD%BF%E7%94%A8shell%E4%B9%9F%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A%E5%86%99%E5%88%B0%E8%84%9A%E6%9C%AC%E6%97%B6%EF%BC%8Ccopy%E5%88%B0%E8%BF%9C%E7%A8%8B%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%86%8D%E6%8A%8A%E9%9C%80%E8%A6%81%E7%9A%84%E7%BB%93%E6%9E%9C%E6%8B%89%E5%9B%9E%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E6%9C%BA%E5%99%A8%0A*%20script%EF%BC%9A%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC%0A%20%20%20%20-%20-a%20%22%2FPATH%2FTO%2FSCRIPT_FILE%22%0A%20%20%20%20-%20ansible%20websrvs%20-m%20script%20-a%20f1.sh%0A*%20copy%EF%BC%9A%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%0A%20%20%20%20-%20ansible%20srv%20-m%20copy%20-a%20%22src%3D%2Froot%2Ff1.sh%20dest%3D%2Ftmp%2Ff2.sh%20owner%3Dwang%20mode%3D600%20backup%3Dyes%22%20%20%20%20%23%E5%A6%82%E6%9E%9C%E7%9B%AE%E6%A0%87%E5%AD%98%E5%9C%A8%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%A6%86%E7%9B%96%EF%BC%8C%E6%AD%A4%E5%A4%84%E6%8C%87%E5%AE%9A%E5%85%88%E5%A4%87%E4%BB%BD%0A%20%20%20%20-%20ansible%20src%20-m%20copy%20-a%20%22content%3D'test%20content%5Cn'%20dest%3D%2Ftmp%2Ff1.txt%22%20%20%20%20%23%E5%88%A9%E7%94%A8%E5%86%85%E5%AE%B9%EF%BC%8C%E7%9B%B4%E6%8E%A5%E7%94%9F%E6%88%90%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%0A*%20fetch%EF%BC%9A%E4%BB%8E%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%96%E6%96%87%E4%BB%B6%E8%87%B3%E6%9C%8D%E5%8A%A1%E7%AB%AF%EF%BC%8Ccopy%E7%9B%B8%E5%8F%8D%EF%BC%8C%E7%9B%AE%E5%BD%95%E5%8F%AF%E5%85%88tar%0A%20%20%20%20-%20ansible%20srv%20-m%20fetch%20-a%20'src%3D%2Froot%2Fa.sh%20dest%3D%2Fdata%2Fscripts'%0A*%20file%EF%BC%9A%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%0A%20%20%20%20-%20ansible%20srv%20-m%20file%20-a%20%22path%3D%2Froot%2Fa.sh%20owner%3Dwang%20mode%3D755%22%0A%20%20%20%20-%20ansible%20web%20-m%20file%20-a%20%22src%3D%2Fapp%2Ftestfile%20dest%3D%2Fapp%2Ftestfile-link%20state%3Dlink%22%0A*%20service%EF%BC%9A%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%0A%20%20%20%20-%20ansible%20srv%20-m%20service%20-a%20'name%3Dhttpd%20state%3Dstopped'%0A%20%20%20%20-%20ansible%20srv%20-m%20service%20-a%20'name%3Dhttpd%20state%3Dstarted'%0A%20%20%20%20-%20ansible%20srv%20-m%20service%20-a%20'name%3Dhttpd%20state%3Dreloaded'%0A%20%20%20%20-%20ansible%20srv%20-m%20service%20-a%20'name%3Dhttpd%20state%3Drestarted'%0A*%20user%EF%BC%9A%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7%0A%20%20%20%20-%20ansible%20srv%20-m%20user%20-a%20'name%3Duser1%20comment%3D%22test%20user%22%20uid%3D2048%20home%3D%2Fapp%2Fuser1%20group%3Droot'%0A%20%20%20%20-%20ansible%20srv%20-m%20user%20-a%20'name%3Dsysuser1%20system%3Dyes%20home%3D%2Fapp%2Fsysuser1'%0A%20%20%20%20-%20ansible%20srv%20-m%20user%20-a%20'name%3Duser1%20state%3Dabsent%20remove%3Dyes'%20%20%20%20%23%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E5%8F%8A%E5%AE%B6%E7%9B%AE%E5%BD%95%E7%AD%89%E6%95%B0%E6%8D%AE%0A*%20group%EF%BC%9A%E7%AE%A1%E7%90%86%E7%BB%84%0A%20%20%20%20-%20ansible%20srv%20-m%20group%20-a%20'name%3Dtestgroup%20system%3Dyes'%0A%20%20%20%20-%20ansible%20srv%20-m%20group%20-a%20'name%3Dtestgroup%20state%3Dabsent'%0A*%20hostname%EF%BC%9A%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E5%90%8D%0A%20%20%20%20-%20ansible%20node1%20-m%20hostname%20-a%20'name%3Dwebsrv'%0A*%20cron%EF%BC%9A%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%94%AF%E6%8C%81%E6%97%B6%E9%97%B4%EF%BC%9Aminute%2C%20hour%2C%20day%2C%20month%2C%20weekday%0A%20%20%20%20-%20ansible%20srv%20-m%20cron%20-a%20%22minute%3D%5C*%2F5%20job%3D'%2Fusr%2Fsbin%2Fntpdate%20172.16.0.1%20%26%3E%2Fdev%2Fnull'%20name%3DSynctime%22%20%20%20%20%23%E5%88%9B%E5%BB%BA%E4%BB%BB%E5%8A%A1%0A%20%20%20%20-%20ansible%20srv%20-m%20cron%20-a%20'state%3Dabsent%20name%3DSynctime'%20%20%20%20%23%E5%88%A0%E9%99%A4%E4%BB%BB%E5%8A%A1%0A*%20yum%EF%BC%9A%E7%AE%A1%E7%90%86%E5%8C%85%0A%20%20%20%20-%20ansible%20srv%20-m%20yum%20-a%20'name%3Dhttpd%20state%3Dlatest'%20%20%20%20%23%E5%AE%89%E8%A3%85%0A%20%20%20%20-%20ansible%20srv%20-m%20yum%20-a%20'name%3Dhttpd%20state%3Dabsent'%20%20%20%20%23%E5%88%A0%E9%99%A4%0A*%20ansible-galaxy%0A%20%20%20%20-%20%E8%BF%9E%E6%8E%A5https%3A%2F%2Fgalaxy.ansible.com%E4%B8%8B%E8%BD%BD%E7%9B%B8%E5%BA%94%E7%9A%84roles%0A%20%20%20%20-%20%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E5%B7%B2%E5%AE%89%E8%A3%85%E7%9A%84galaxy%0A%20%20%20%20%20%20%20%20ansible-galaxy%20list%0A%20%20%20%20-%20%E5%AE%89%E8%A3%85galaxy%0A%20%20%20%20%20%20%20%20ansible-galaxy%20install%20geerlingguy.redis%0A%20%20%20%20-%20%E5%88%A0%E9%99%A4galaxy%0A%20%20%20%20%20%20%20%20ansible-galaxy%20remove%20geerlingguy.redis%0A*%20ansible-pull%0A%20%20%20%20%E6%8E%A8%E9%80%81%E5%91%BD%E4%BB%A4%E8%87%B3%E8%BF%9C%E7%A8%8B%EF%BC%8C%E6%95%88%E7%8E%87%E6%97%A0%E9%99%90%E6%8F%90%E5%8D%87%EF%BC%8C%E5%AF%B9%E8%BF%90%E7%BB%B4%E8%A6%81%E6%B1%82%E9%AB%98%0A*%20ansible-playbook%0A%20%20%20%20ansible-playbook%20hello.yml%0A%60%60%60%0Acat%20hello.yml%0A%23hello%20world%20yml%20file%0A-%20hosts%3A%20websrvs%0A%20%20remote_user%3A%20root%0A%20%20tasks%3A%0A%20%20%20%20-%20name%3A%20hello%20world%0A%20%20%20%20%20%20command%3A%20%2Fusr%2Fbin%2Fwall%20hello%20world%0A%60%60%60%0A*%20ansible-vault%0A%20%20%20%20-%20%E5%8A%9F%E8%83%BD%EF%BC%9A%E7%AE%A1%E7%90%86%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86yml%E6%96%87%E4%BB%B6%0A%20%20%20%20-%20ansible-vault%20%5Bcreate%7Cdecrypt%7Cedit%7Cencrypt%7Crekey%7Cview%5D%0A%20%20%20%20-%20ansible-vault%20encrypt%20hello.yml%20%20%20%20%E5%8A%A0%E5%AF%86%0A%20%20%20%20-%20ansible-vault%20decrypt%20hello.yml%20%20%20%20%E8%A7%A3%E5%AF%86%0A%20%20%20%20-%20ansible-vault%20view%20hello.yml%20%20%20%20%20%20%20%20%E6%9F%A5%E7%9C%8B%0A%20%20%20%20-%20ansible-vault%20edit%20hello.yml%20%20%20%20%20%20%20%20%E7%BC%96%E8%BE%91%E5%8A%A0%E5%AF%86%E6%96%87%E4%BB%B6%0A%20%20%20%20-%20ansible-vault%20rekey%20hello.yml%20%20%20%20%20%20%E4%BF%AE%E6%94%B9%E5%8F%A3%E4%BB%A4%0A%20%20%20%20-%20ansible-vault%20create%20new.yml%20%20%20%20%20%20%E5%88%9B%E5%BB%BA%E6%96%B0%E6%96%87%E4%BB%B6%0A*%20ansible-console%EF%BC%9A2.0%2B%E6%96%B0%E5%A2%9E%EF%BC%8C%E5%8F%AF%E4%BA%A4%E4%BA%92%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%94%AF%E6%8C%81tab%0A%20%20%20%20-%20root%40test(2)%5Bf%3A10%5D%24%0A%20%20%20%20-%20%E8%AE%BE%E7%BD%AE%E5%B9%B6%E5%8F%91%E6%95%B0%EF%BC%9Afork%20n%20%E4%BE%8B%E5%A6%82%EF%BC%9Aforks%2010%0A%20%20%20%20-%20%E5%88%87%E6%8D%A2%E7%BB%84%EF%BC%9Acd%20%E4%B8%BB%E6%9C%BA%E7%BB%84%20%E4%BE%8B%E5%A6%82%EF%BC%9Acd%20web%0A%20%20%20%20-%20%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%BB%84%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%EF%BC%9Alist%0A%20%20%20%20-%20%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E7%9A%84%E5%86%85%E7%BD%AE%E5%91%BD%E4%BB%A4%EF%BC%9A%3F%E6%88%96help%0A%20%20%20%20-%20%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%20%20%20%20%60%0A%20%20%20%20root%40all(2)%5Bf%3A5%5D%24%20list%0A%20%20%20%20root%40all(2)%5Bf%3A5%5D%24%20cd%20appsrvs%0A%20%20%20%20root%40appsrvs(2)%5Bf%3A5%5D%24%20list%0A%20%20%20%20root%40appsrvs(2)%5Bf%3A5%5D%24%20yum%20name%3Dhttpd%20state%3Dpresent%0A%20%20%20%20root%40appsrvs(2)%5Bf%3A5%5D%24%20service%20name%3Dhttpd%20state%3Dstarted%0A%20%20%20%20%60%0A%0A%23%23%20playbook%0A*%20playbook%E6%98%AF%E7%94%B1%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%22play%22%E7%BB%84%E6%88%90%E7%9A%84%E5%88%97%E8%A1%A8%0A*%20play%E7%9A%84%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E5%9C%A8%E4%BA%8E%E5%B0%86%E4%BA%8B%E5%85%88%E5%BD%92%E5%B9%B6%E4%B8%BA%E4%B8%80%E7%BB%84%E7%9A%84%E4%B8%BB%E6%9C%BA%E8%A3%85%E6%89%AE%E6%88%90%E4%BA%8B%E5%85%88%E9%80%9A%E8%BF%87ansible%E4%B8%AD%E7%9A%84task%E5%AE%9A%E4%B9%89%E5%A5%BD%E7%9A%84%E8%A7%92%E8%89%B2%E3%80%82%E4%BB%8E%E6%A0%B9%E6%9C%AC%E4%B8%8A%E6%9D%A5%E8%AE%B2%EF%BC%8C%E6%89%80%E8%B0%93task%E6%97%A0%E9%9D%9E%E6%98%AF%E8%B0%83%E7%94%A8ansible%E7%9A%84%E4%B8%80%E4%B8%AAmodule%E3%80%82%E5%B0%86%E5%A4%9A%E4%B8%AAplay%E7%BB%84%E7%BB%87%E5%9C%A8%E4%B8%80%E4%B8%AAplaybook%E4%B8%AD%EF%BC%8C%E5%8D%B3%E5%8F%AF%E4%BB%A5%E8%AE%A9%E5%AE%83%E4%BB%AC%E8%81%94%E5%90%8C%E8%B5%B7%E6%9D%A5%E6%8C%89%E4%BA%8B%E5%85%88%E7%BC%96%E6%8E%92%E7%9A%84%E6%9C%BA%E5%88%B6%E5%90%8C%E5%94%B1%E4%B8%80%E5%8F%B0%E5%A4%A7%E6%88%8F%0A*%20playbook%E9%87%87%E7%94%A8YAML%E8%AF%AD%E8%A8%80%E7%BC%96%E5%86%99%0A%23%23%20YAML%E8%AF%AD%E6%B3%95%E7%AE%80%E4%BB%8B%0A*%20%E5%9C%A8%E5%8D%95%E4%B8%80%E6%A1%A3%E6%A1%88%E4%B8%AD%EF%BC%8C%E5%8F%AF%E7%94%A8%E8%BF%9E%E7%BB%AD%E4%B8%89%E4%B8%AA%E8%BF%9E%E5%AD%97%E5%8F%B7(---)%E5%8C%BA%E5%88%86%E5%A4%9A%E4%B8%AA%E6%A1%A3%E6%A1%88%E3%80%82%E5%8F%A6%E5%A4%96%EF%BC%8C%E8%BF%98%E6%9C%89%E9%80%89%E6%8B%A9%E6%80%A7%E7%9A%84%E8%BF%9E%E7%BB%AD%E4%B8%89%E4%B8%AA%E7%82%B9%E5%8F%B7(...)%E7%94%A8%E6%9D%A5%E8%A1%A8%E7%A4%BA%E6%A1%A3%E6%A1%88%E7%BB%93%E5%B0%BE%0A*%20%E6%AC%A1%E8%A1%8C%E5%BC%80%E5%A7%8B%E6%AD%A3%E5%B8%B8%E5%86%99playbook%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E4%B8%80%E8%88%AC%E5%BB%BA%E8%AE%AE%E5%86%99%E6%98%8E%E8%AF%A5playbook%E7%9A%84%E5%8A%9F%E8%83%BD%0A*%20%E4%BD%BF%E7%94%A8%23%E5%8F%B7%E6%B3%A8%E9%87%8A%E4%BB%A3%E7%A0%81%0A*%20%E7%BC%A9%E8%BF%9B%E5%BF%85%E9%A1%BB%E6%98%AF%E7%BB%9F%E4%B8%80%E7%9A%84%EF%BC%8C%E4%B8%8D%E8%83%BD%E7%A9%BA%E6%A0%BC%E5%92%8Ctab%E6%B7%B7%E7%94%A8%0A*%20%E7%BC%A9%E8%BF%9B%E7%9A%84%E7%BA%A7%E5%88%AB%E4%B9%9F%E5%BF%85%E9%A1%BB%E6%98%AF%E4%B8%80%E8%87%B4%E7%9A%84%EF%BC%8C%E5%90%8C%E6%A0%B7%E7%9A%84%E7%BC%A9%E8%BF%9B%E4%BB%A3%E8%A1%A8%E5%90%8C%E6%A0%B7%E7%9A%84%E7%BA%A7%E5%88%AB%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%88%A4%E5%88%AB%E9%85%8D%E7%BD%AE%E7%9A%84%E7%BA%A7%E5%88%AB%E6%98%AF%E9%80%9A%E8%BF%87%E7%BC%A9%E8%BF%9B%E7%BB%93%E5%90%88%E6%8D%A2%E8%A1%8C%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%9A%84%0A*%20YAML%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E5%92%8CLinux%E7%B3%BB%E7%BB%9F%E5%A4%A7%E5%B0%8F%E5%86%99%E5%88%A4%E6%96%AD%E6%96%B9%E5%BC%8F%E4%BF%9D%E6%8C%81%E4%B8%80%E8%87%B4%EF%BC%8C%E6%98%AF%E5%8C%BA%E5%88%AB%E5%A4%A7%E5%B0%8F%E5%86%99%E7%9A%84%EF%BC%8Ck%2Fv%E7%9A%84%E5%80%BC%E5%9D%87%E9%9C%80%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F%0A*%20k%2Fv%E7%9A%84%E5%80%BC%E5%8F%AF%E5%90%8C%E8%A1%8C%E5%86%99%E4%B9%9F%E5%8F%AF%E6%8D%A2%E8%A1%8C%E5%86%99%E3%80%82%E5%90%8C%E8%A1%8C%E4%BD%BF%E7%94%A8%3A%E5%88%86%E9%9A%94%0A*%20v%E5%8F%AF%E6%98%AF%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E4%B9%9F%E5%8F%AF%E6%98%AF%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%88%97%E8%A1%A8%0A*%20%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%95%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E5%9D%97%E5%8A%9F%E8%83%BD%E9%9C%80%E8%A6%81%E6%9C%80%E5%B0%91%E5%85%83%E7%B4%A0%E5%8C%85%E6%8B%ACname%3A%20task%0A*%20%E4%B8%80%E4%B8%AAname%E5%8F%AA%E8%83%BD%E5%8C%85%E6%8B%AC%E4%B8%80%E4%B8%AAtask%0A*%20YAML%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D%E9%80%9A%E5%B8%B8%E4%B8%BAyml%E6%88%96yaml%0A*%20list%EF%BC%9A%E5%88%97%E8%A1%A8%EF%BC%8C%E5%85%B6%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%E5%9D%87%E4%BD%BF%E7%94%A8%22-%22%E6%89%93%E5%A4%B4%0A%60%60%60%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%23a%20list%20of%20tasty%20fruits%0A-%20app%0A-%20orange%0A-%20strawberry%0A-%20mango%0A%60%60%60%0A*%20dictionary%EF%BC%9A%E5%AD%97%E5%85%B8%EF%BC%8C%E9%80%9A%E5%B8%B8%E7%94%B1%E5%A4%9A%E4%B8%AAkey%E4%B8%8Evalue%E6%9E%84%E6%88%90%0A%60%60%60%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%23an%20employee%20record%0Aname%3A%20example%20developer%0Ajob%3A%20developer%0Askill%3A%20elite%0A%0A%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%B0%86key%3Avalue%E6%94%BE%E7%BD%AE%E4%BA%8E%7B%7D%E4%B8%AD%E8%BF%9B%E8%A1%8C%E8%A1%A8%E7%A4%BA%EF%BC%8C%E7%94%A8%22%2C%22%E5%88%86%E9%9A%94%E5%A4%9A%E4%B8%AAkey%3Avalue%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%23an%20employee%20record%0A%7Bname%3A%20example%20developer%2C%20job%3Adeveloper%2C%20skill%3Aelite%7D%0A%60%60%60%0A*%20YAML%E7%9A%84%E8%AF%AD%E6%B3%95%E5%92%8C%E5%85%B6%E4%BB%96%E9%AB%98%E9%98%B6%E8%AF%AD%E8%A8%80%E7%B1%BB%E4%BC%BC%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%8F%AF%E4%BB%A5%E7%AE%80%E5%8D%95%E8%A1%A8%E8%BE%BE%E6%B8%85%E5%8D%95%E3%80%81%E6%95%A3%E5%88%97%E8%A1%A8%E3%80%81%E6%A0%87%E9%A2%98%E7%AD%89%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%82%E5%85%B6%E7%BB%93%E6%9E%84%EF%BC%88structure%EF%BC%89%E9%80%9A%E8%BF%87%E7%A9%BA%E6%A0%BC%E6%9D%A5%E5%B1%95%E7%A4%BA%EF%BC%8C%E5%BA%8F%E5%88%97%EF%BC%88sequence%EF%BC%89%E9%87%8C%E7%9A%84%E9%A1%B9%E7%94%A8%22-%22%E6%9D%A5%E4%BB%A3%E8%A1%A8%EF%BC%8Cmap%E9%87%8C%E7%9A%84%E9%94%AE%E5%80%BC%E5%AF%B9%E7%94%A8%22%3A%22%E5%88%86%E9%9A%94%0A%60%60%60%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0Aname%3A%20John%20Smith%0Aage%3A%2041%0Agender%3A%20Male%0Aspouse%3A%0A%20%20name%3A%20Jane%20Smith%0A%20%20age%3A%2037%0A%20%20gender%3A%20Female%0Achildren%3A%0A-%20name%3A%20Jimmy%20Smith%0A%20%20age%3A%2017%0A%20%20gender%3A%20Male%0A-%20name%3A%20jenny%20Smith%0A%20%20age%3A%2013%0A%20%20fender%3A%20Female%0A%60%60%60%0A%23%23%23%20playbook%E6%A0%B8%E5%BF%83%E5%85%83%E7%B4%A0%0A*%20hosts%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%0A*%20tasks%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E4%BB%BB%E5%8A%A1%E9%9B%86%0A*%20varniables%20%20%20%20%20%20%20%20%20%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F%E6%88%96%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%E5%9C%A8playbook%E4%B8%AD%E8%B0%83%E7%94%A8%0A*%20templates%20%20%20%20%20%20%20%20%20%E6%A8%A1%E6%9D%BF%EF%BC%8C%E5%8F%AF%E6%9B%BF%E6%8D%A2%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E5%B9%B6%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E9%80%BB%E8%BE%91%E6%96%87%E4%BB%B6%0A*%20handlers%20%20%20%20%20%20%20%20%20%20%20%E5%92%8Cnotify%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%EF%BC%8C%E7%94%B1%E7%89%B9%E5%AE%9A%E6%9D%A1%E4%BB%B6%E8%A7%A6%E5%8F%91%E6%93%8D%E4%BD%9C%EF%BC%8C%E6%BB%A1%E8%B6%B3%E6%9D%A1%E4%BB%B6%E4%B8%BB%E6%89%8D%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%90%A6%E5%88%99%E4%B8%8D%E6%89%A7%E8%A1%8C%0A*%20tags%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%A0%87%E7%AD%BE%EF%BC%8C%E6%8C%87%E5%AE%9A%E6%9F%90%E6%9D%A1%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%EF%BC%8C%E7%94%A8%E4%BA%8E%E9%80%89%E6%8B%A9%E8%BF%90%E8%A1%8Cplaybook%E4%B8%AD%E7%9A%84%E9%83%A8%E5%88%86%E4%BB%A3%E7%A0%81%E3%80%82ansible%E5%85%B7%E6%9C%89%E5%B9%82%E7%AD%89%E6%80%A7%EF%BC%8C%E5%9B%A0%E6%AD%A4%E4%BC%9A%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BF%87%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96%E7%9A%84%E9%83%A8%E5%88%86%EF%BC%8C%E5%8D%B3%E4%BE%BF%E5%A6%82%E6%AD%A4%EF%BC%8C%E6%9C%89%E4%BA%9B%E4%BB%A3%E7%A0%81%E4%B8%BA%E6%B5%8B%E8%AF%95%E5%85%B6%E7%A1%AE%E5%AE%9E%E6%B2%A1%E6%9C%89%E5%8F%91%E7%94%9F%E5%8F%98%E5%8C%96%E7%9A%84%E6%97%B6%E9%97%B4%E4%BE%9D%E7%84%B6%E4%BC%9A%E9%9D%9E%E5%B8%B8%E7%9A%84%E9%95%BF%E3%80%82%E6%AD%A4%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%A1%AE%E4%BF%A1%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87tags%E8%B7%B3%E8%BF%87%E9%82%A3%E4%BA%9B%E4%BB%A3%E7%A0%81%E7%89%87%E6%96%AD%EF%BC%8Cansible-playbook%20-t%20tagsname%20useradd.yml%0A%23%23%23%20playbook%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%0A*%20remote_user%20%20%20%20%20%E5%8F%AF%E7%94%A8%E4%BA%8Ehost%E5%92%8Ctask%E4%B8%AD%E3%80%82%E4%B9%9F%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E6%8C%87%E5%AE%9A%E5%85%B6%E9%80%9A%E8%BF%87sudo%E7%9A%84%E6%96%B9%E5%BC%8F%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E4%B8%8A%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%8C%E5%85%B6%E5%8F%AF%E7%94%A8%E4%BA%8Eplay%E5%85%A8%E5%B1%80%E6%88%96%E6%9F%90%E4%BB%BB%E5%8A%A1%EF%BC%9B%E6%AD%A4%E5%A4%96%EF%BC%8C%E7%94%9A%E8%87%B3%E5%8F%AF%E4%BB%A5%E5%9C%A8sudo%E6%97%B6%E4%BD%BF%E7%94%A8sudo_user%E6%8C%87%E5%AE%9Asudo%E6%97%B6%E5%88%87%E6%8D%A2%E7%9A%84%E7%94%A8%E6%88%B7%0A%60%60%60%0A-%20host%3A%20websrvs%0A%20%20remote_user%3A%20root%0A%20%20tasks%3A%0A%20%20-%20name%3A%20test%20connection%0A%20%20%20%20ping%3A%0A%20%20%20%20remote_user%3A%20magedu%0A%20%20%20%20sudo%3A%20yes%0A%20%20%20%20sudo_user%3A%20wang%0A%60%60%60%0A*%20hosts%0A%20%20%20%20-%20playbook%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%80%E4%B8%AAplay%E7%9A%84%E7%9B%AE%E7%9A%84%E9%83%BD%E6%98%AF%E4%B8%BA%E4%BA%86%E8%AE%A9%E6%9F%90%E4%B8%AA%E6%88%96%E6%9F%90%E4%BA%9B%E4%B8%BB%E6%9C%BA%E4%BB%A5%E6%9F%90%E4%B8%AA%E6%8C%87%E5%AE%9A%E7%9A%84%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E3%80%82hosts%E7%94%A8%E4%BA%8E%E6%8C%87%E5%AE%9A%E8%A6%81%E6%89%A7%E8%A1%8C%E6%8C%87%E5%AE%9A%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%B8%BB%E6%9C%BA%EF%BC%8C%E9%A1%BB%E4%BA%8B%E5%85%88%E5%AE%9A%E4%B9%89%E5%9C%A8%E4%B8%BB%E6%9C%BA%E6%B8%85%E5%8D%95%E4%B8%AD%0A%20%20%20%20-%20%E5%8F%AF%E4%BB%A5%E6%98%AF%E5%A6%82%E4%B8%8B%E5%BD%A2%E5%BC%8F%EF%BC%9A%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20%20one.example.com%0A%20%20%20%20%20%20%20%20one.example.com%3Atwo.example.com%0A%20%20%20%20%20%20%20%20192.168.1.50%0A%20%20%20%20%20%20%20%20192.168.1.*%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20-%20websrvs%3Adbsrvs%20%20%20%20%20%20%20%20%E4%B8%A4%E4%B8%AA%E7%BB%84%E7%9A%84%E5%B9%B6%E9%9B%86%0A%20%20%20%20-%20websrvs%3A%26dbsrvs%20%20%20%20%20%20%E4%B8%A4%E4%B8%AA%E7%BB%84%E7%9A%84%E4%BA%A4%E9%9B%86%0A%20%20%20%20-%20websrvs%3A!phoenix%20%20%20%20%20%E5%9C%A8websrvs%E7%BB%84%EF%BC%8C%E4%BD%86%E4%B8%8D%E5%9C%A8dbsrvs%E7%BB%84%20%20%20%20%0A%20%20%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%20%20%20%20%20%20%20%20-%20hosts%3A%20websrvs%3Adbsrvs%0A%20%20%20%20%20%20%20%20%60%60%60%0A*%20task%E5%88%97%E8%A1%A8%E5%92%8Caction%0A%20%20%20%20-%20play%E7%9A%84%E4%B8%BB%E4%BD%93%E9%83%A8%E5%88%86%E6%98%AFtask%20list%E3%80%82task%20list%E4%B8%AD%E7%9A%84%E5%90%84%E4%BB%BB%E5%8A%A1%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%90%E4%B8%AA%E5%9C%A8hosts%E4%B8%AD%E6%8C%87%E5%AE%9A%E7%9A%84%E6%89%80%E6%9C%89%E4%B8%BB%E6%9C%BA%E4%B8%8A%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%8D%B3%E5%9C%A8%E6%89%80%E6%9C%89%E4%B8%BB%E6%9C%BA%E4%B8%8A%E5%AE%8C%E6%88%90%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%BB%BB%E5%8A%A1%E5%90%8E%E5%86%8D%E5%BC%80%E5%A7%8B%E7%AC%AC%E4%BA%8C%E4%B8%AA%E3%80%82%E5%9C%A8%E8%BF%90%E8%A1%8C%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E6%9F%90playbook%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%AD%E9%80%94%E5%8F%91%E7%94%9F%E9%94%99%E8%AF%AF%EF%BC%8C%E6%89%80%E6%9C%89%E5%B7%B2%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E9%83%BD%E5%B0%86%E5%9B%9E%E6%BB%9A%EF%BC%8C%E5%9B%A0%E6%AD%A4%EF%BC%8C%E5%9C%A8%E6%9B%B4%E6%AD%A3playbook%E5%90%8E%E9%87%8D%E6%96%B0%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1%E5%8D%B3%E5%8F%AF%0A%20%20%20%20-%20task%E7%9A%84%E7%9B%AE%E7%9A%84%E6%98%AF%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84%E5%8F%82%E6%95%B0%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9D%97%EF%BC%8C%E8%80%8C%E5%9C%A8%E6%A8%A1%E5%9D%97%E5%8F%82%E6%95%B0%E4%B8%AD%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F%E3%80%82%E6%A8%A1%E5%9D%97%E6%89%A7%E8%A1%8C%E6%98%AF%E5%B9%82%E7%AD%89%E7%9A%84%EF%BC%8C%E8%BF%99%E6%84%8F%E5%91%B3%E7%9D%80%E5%A4%9A%E6%AC%A1%E6%89%A7%E8%A1%8C%E6%98%AF%E5%AE%89%E5%85%A8%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%85%B6%E7%BB%93%E6%9E%9C%E5%9D%87%E4%B8%80%E8%87%B4%0A%20%20%20%20-%20%E6%AF%8F%E4%B8%AAtask%E9%83%BD%E5%BA%94%E8%AF%A5%E6%9C%89%E5%85%B6name%EF%BC%8C%E7%94%A8%E4%BA%8Eplaybook%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA%EF%BC%8C%E5%BB%BA%E8%AE%AE%E5%85%B6%E5%86%85%E5%AE%B9%E5%B0%BD%E5%8F%AF%E8%83%BD%E6%B8%85%E6%99%B0%E6%8F%8F%E8%BF%B0%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E6%AD%A5%E9%AA%A4%E3%80%82%E5%A6%82%E6%9E%9C%E6%9C%AA%E6%8F%90%E4%BE%9Bname%EF%BC%8C%E5%88%99action%E7%9A%84%E7%BB%93%E6%9E%9C%E5%B0%86%E7%94%A8%E4%BA%8E%E8%BE%93%E5%87%BA%0A%20%20%20%20-%20task%EF%BC%9A%E4%BB%BB%E5%8A%A1%E5%88%97%E8%A1%A8%0A%20%20%20%20-%20%E6%A0%BC%E5%BC%8F%EF%BC%9A(1)%20action%3A%20module%20arguments%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20(2)%20module%3A%20arguments%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%B3%A8%E6%84%8F%EF%BC%9Ashell%E5%92%8Ccommand%E6%A8%A1%E5%9D%97%E5%90%8E%E9%9D%A2%E8%B7%9F%E5%91%BD%E4%BB%A4%EF%BC%8C%E8%80%8C%E9%9D%9Ekey%3Dvalue%0A%20%20%20%20-%20%E6%9F%90%E4%BB%BB%E5%8A%A1%E7%9A%84%E7%8A%B6%E6%80%81%E5%9C%A8%E8%BF%90%E8%A1%8C%E5%90%8E%E4%B8%BAchanged%E6%97%B6%EF%BC%8C%E5%8F%AF%E9%80%9A%E8%BF%87%22notify%22%E9%80%9A%E7%9F%A5%E7%BB%99%E7%9B%B8%E5%BA%94%E7%9A%84handlers%0A%20%20%20%20-%20%E4%BB%BB%E5%8A%A1%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%22tags%22%E6%89%93%E6%A0%87%E7%AD%BE%EF%BC%8C%E8%80%8C%E5%90%8E%E5%8F%AF%E5%9C%A8ansible-playbook%E5%91%BD%E4%BB%A4%E4%B8%8A%E4%BD%BF%E7%94%A8-t%E6%8C%87%E5%AE%9A%E8%BF%9B%E8%A1%8C%E8%B0%83%E7%94%A8%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%20%20%20%20%20%20%20%20task%3A%0A%20%20%20%20%20%20%20%20%20%20-%20name%3A%20disabled%20selinux%0A%20%20%20%20%20%20%20%20%20%20%20%20command%3A%20%2Fsbin%2Fsetenforce%200%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20-%20%E5%A6%82%E6%9E%9C%E5%91%BD%E4%BB%A4%E6%88%96%E8%84%9A%E6%9C%AC%E7%9A%84%E9%80%80%E5%87%BA%E7%A0%81%E4%B8%8D%E4%B8%BA%E9%9B%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%A6%82%E4%B8%8B%E6%96%B9%E5%BC%8F%E6%9B%BF%E4%BB%A3%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20tasks%3A%0A%20%20%20%20%20%20%20%20%20%20-%20name%3A%20run%20this%20command%20and%20ignore%20the%20result%0A%20%20%20%20%20%20%20%20%20%20%20%20shell%3A%20%2Fusr%2Fbin%2Fsomecommad%20%7C%7C%20%2Fbin%2Ftrue%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20-%20%E6%88%96%E8%80%85%E4%BD%BF%E7%94%A8ignore_errors%E6%9D%A5%E5%BF%BD%E7%95%A5%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20tasks%3A%0A%20%20%20%20%20%20%20%20%20%20-%20name%3A%20run%20this%20command%20and%20ignore%20the%20result%0A%20%20%20%20%20%20%20%20%20%20%20shell%3A%20%2Fusr%2Fbin%2Fsomecommand%0A%20%20%20%20%20%20%20%20%20%20%20ignore_errors%3A%20true%0A%20%20%20%20%20%20%20%20%60%60%60%0A*%20handlers%E5%92%8Cnotify%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6%0A%20%20%20%20-%20handlers%EF%BC%8C%E6%98%AFtask%E5%88%97%E8%A1%A8%EF%BC%8C%E8%BF%99%E4%BA%9Btask%E4%B8%8E%E5%89%8D%E8%BF%B0%E7%9A%84task%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%9C%AC%E8%B4%A8%E4%B8%8A%E7%9A%84%E4%B8%8D%E5%90%8C%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%BD%93%E5%85%B3%E6%B3%A8%E7%9A%84%E8%B5%84%E6%BA%90%E5%8F%91%E7%94%9F%E5%8F%98%E5%8C%96%E6%97%B6%EF%BC%8C%E6%89%8D%E4%BC%9A%E9%87%87%E5%8F%96%E4%B8%80%E5%AE%9A%E7%9A%84%E6%93%8D%E4%BD%9C%E3%80%82%0A%20%20%20%20-%20notify%E6%AD%A4action%E5%8F%AF%E7%94%A8%E4%BA%8E%E6%AF%8F%E4%B8%AAplay%E7%9A%84%E6%9C%80%E5%90%8E%E8%A2%AB%E8%A7%A6%E5%8F%91%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E9%81%BF%E5%85%8D%E5%A4%9A%E6%AC%A1%E6%9C%89%E6%94%B9%E5%8F%98%E5%8F%91%E7%94%9F%E6%97%B6%E6%AF%8F%E6%AC%A1%E9%83%BD%E6%89%A7%E8%A1%8C%E6%8C%87%E5%AE%9A%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BB%85%E5%9C%A8%E6%89%80%E6%9C%89%E7%9A%84%E5%8F%98%E5%8C%96%E5%8F%91%E7%94%9F%E5%AE%8C%E6%88%90%E5%90%8E%E4%B8%80%E6%AC%A1%E6%80%A7%E5%9C%B0%E6%89%A7%E8%A1%8C%E6%8C%87%E5%AE%9A%E6%93%8D%E4%BD%9C%E3%80%82%E5%9C%A8notify%E4%B8%AD%E5%88%97%E5%87%BA%E7%9A%84%E6%93%8D%E4%BD%9C%E7%A7%B0%E4%B8%BAhandler%EF%BC%8C%E4%B9%9F%E5%8D%B3notify%E4%B8%AD%E8%B0%83%E7%94%A8handler%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84%E6%93%8D%E4%BD%9C%E3%80%82%0A%23%23%23%20playbook%E4%B8%AD%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8%0A*%20%E5%8F%98%E9%87%8F%E5%90%8D%EF%BC%9A%E4%BB%85%E8%83%BD%E7%94%B1%E5%AD%97%E6%AF%8D%E3%80%81%E6%95%B0%E5%AD%97%E5%92%8C%E4%B8%8B%E5%88%92%E7%BA%BF%E7%BB%84%E6%88%90%EF%BC%8C%E4%B8%94%E5%8F%AA%E8%83%BD%E4%BB%A5%E5%AD%97%E6%AF%8D%E5%BC%80%E5%A4%B4%0A*%20%E5%8F%98%E9%87%8F%E6%9D%A5%E6%BA%90%EF%BC%9A%0A%20%20%20%201.%20ansible%20setup%20facts%20%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%89%80%E6%9C%89%E5%8F%98%E9%87%8F%E9%83%BD%E5%8F%AF%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8%0A%20%20%20%202.%20%E5%9C%A8%2Fetc%2Fansible%2Fhosts%E4%B8%AD%E5%AE%9A%E4%B9%89%0A%20%20%20%20%E6%99%AE%E9%80%9A%E5%8F%98%E9%87%8F%EF%BC%9A%E4%B8%BB%E6%9C%BA%E7%BB%84%E4%B8%AD%E4%B8%BB%E6%9C%BA%E5%8D%95%E7%8B%AC%E5%AE%9A%E4%B9%89%EF%BC%8C%E4%BC%98%E5%85%88%E7%BA%A7%E9%AB%98%E4%BA%8E%E5%85%AC%E5%85%B1%E5%8F%98%E9%87%8F%0A%20%20%20%20%E5%85%AC%E5%85%B1%EF%BC%88%E7%BB%84%EF%BC%89%E5%8F%98%E9%87%8F%EF%BC%9A%E9%92%88%E5%AF%B9%E4%B8%BB%E6%9C%BA%E7%BB%84%E4%B8%AD%E6%89%80%E6%9C%89%E4%B8%BB%E6%9C%BA%E5%AE%9A%E4%B9%89%E7%BB%9F%E4%B8%80%E5%8F%98%E9%87%8F%0A%20%20%20%203.%20%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8C%87%E5%AE%9A%E5%8F%98%E9%87%8F%EF%BC%8C%E4%BC%98%E5%85%88%E7%BA%A7%E6%9C%80%E9%AB%98%0A%20%20%20%20ansible-playbook%20-e%20varname%3Dvalue%0A%20%20%20%204.%20%E5%9C%A8playbook%E4%B8%AD%E5%AE%9A%E4%B9%89%20%0A%60%60%60%0A%20%20%20%20vars%3A%0A%20%20%20%20%20%20-%20var1%3A%20value1%0A%20%20%20%20%20%20-%20var2%3A%20value2%0A%60%60%60%0A%20%20%20%205.%20%E5%9C%A8%E7%8B%AC%E7%AB%8B%E7%9A%84%E5%8F%98%E9%87%8FYAML%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89%0A%20%20%20%206.%20%E5%9C%A8role%E4%B8%AD%E5%AE%9A%E4%B9%89%0A%0A%23%23%23%20%E6%A8%A1%E6%9D%BFtemplates%0A*%20%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B5%8C%E5%A5%97%E6%9C%89%E8%84%9A%E6%9C%AC%EF%BC%88%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BC%96%E5%86%99%EF%BC%89%0A*%20jinja2%E8%AF%AD%E8%A8%80%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%AD%97%E9%9D%A2%E9%87%8F%EF%BC%8C%E6%9C%89%E4%B8%8B%E9%9D%A2%E5%BD%A2%E5%BC%8F%0A%20%20%20%20%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%8D%95%E5%BC%95%E5%8F%B7%E6%88%96%E5%8F%8C%E5%BC%95%E5%8F%B7%0A%20%20%20%20%E6%95%B0%E5%AD%97%EF%BC%9A%E6%95%B4%E6%95%B0%EF%BC%8C%E6%B5%AE%E7%82%B9%E6%95%B0%0A%20%20%20%20%E5%88%97%E8%A1%A8%EF%BC%9A%5Bitem1%2C%20item2%2C%20...%5D%0A%20%20%20%20%E5%85%83%E7%BB%84%EF%BC%9A(item1%2C%20item2%2C%20...)%0A%20%20%20%20%E5%AD%97%E5%85%B8%EF%BC%9A%7Bkey1%3Avalue1%2C%20key2%3Avalue2%2C%20...%7D%0A%20%20%20%20%E5%B8%83%E5%B0%94%E5%9E%8B%EF%BC%9Atrue%2Ffalse%0A*%20%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%EF%BC%9A%2B%2C%20-%2C%20%5C*%2C%20%2F%2C%20%2F%2F%2C%20**%0A*%20%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C%EF%BC%9A%3D%3D%2C%20!%3D%2C%20%3E%2C%20%3E%3D%2C%20%3C%2C%20%3C%3D%0A*%20%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%EF%BC%9Aand%2C%20or%2C%20not%0A*%20%E6%B5%81%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%9Afor%20if%20when%0A*%20templates%E5%8A%9F%E8%83%BD%EF%BC%9A%E6%A0%B9%E6%8D%AE%E6%A8%A1%E5%9D%97%E6%96%87%E4%BB%B6%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E5%AF%B9%E5%BA%94%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%0A%20%20%20%20-%20templates%E6%96%87%E4%BB%B6%E5%BF%85%E9%A1%BB%E5%AD%98%E6%94%BE%E4%BA%8Etemplates%E7%9B%AE%E5%BD%95%E4%B8%8B%EF%BC%8C%E4%B8%94%E5%91%BD%E5%90%8D%E4%B8%BA.j2%E7%BB%93%E5%B0%BE%0A%20%20%20%20-%20yaml%2Fyml%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E5%92%8Ctemplates%E7%9B%AE%E5%BD%95%E5%B9%B3%E7%BA%A7%EF%BC%8C%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%20%20%20%20%20%20%20%20.%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C---temnginx.yml%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C---templates%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C---nginx.conf.j2%0A%0A%23%23%23%23%20when%0A*%20%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%EF%BC%9A%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E6%A0%B9%E6%8D%AE%E5%8F%98%E9%87%8F%E3%80%81facts%E6%88%96%E6%AD%A4%E5%89%8D%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E6%9D%A5%E5%81%9A%E4%B8%BA%E6%9F%90task%E6%89%A7%E8%A1%8C%E4%B8%8E%E5%90%A6%E7%9A%84%E5%89%8D%E6%8F%90%E6%97%B6%E8%A6%81%E7%94%A8%E5%88%B0%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%EF%BC%8C%E9%80%9A%E8%BF%87when%E8%AF%AD%E5%8F%A5%E5%AE%9E%E7%8E%B0%EF%BC%8C%E5%9C%A8task%E4%B8%AD%E4%BD%BF%E7%94%A8%EF%BC%8Cjinja2%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F%0A*%20when%E8%AF%AD%E5%8F%A5%0A*%20%E5%9C%A8task%E5%90%8E%E6%B7%BB%E5%8A%A0when%E5%AD%90%E5%8F%A5%E5%8D%B3%E5%8F%AF%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%EF%BC%9Bwhen%E8%AF%AD%E5%8F%A5%E6%94%AF%E6%8C%81jinja2%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E6%B3%95%0A*%20%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%60%60%60%0Atasks%3A%0A-%20name%3A%20%22shutdown%20RedHat%20flavored%20systems%22%0A%20%20command%3A%20%2Fsbin%2Fshutdown%20-h%20now%0A%20%20when%3A%20ansible_os_family%20%3D%3D%20%22RedHat%22%0A%60%60%60%0A%23%23%23%23%20with_items%0A*%20%E8%BF%AD%E4%BB%A3%EF%BC%9A%E5%BD%93%E6%9C%89%E9%9C%80%E8%A6%81%E9%87%8D%E5%A4%8D%E6%80%A7%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%BB%E5%8A%A1%E6%97%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E8%BF%AD%E4%BB%A3%E6%9C%BA%E5%88%B6%0A%20%20%20%20-%20%E5%AF%B9%E8%BF%AD%E4%BB%A3%E9%A1%B9%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%8C%E5%9B%BA%E5%AE%9A%E5%8F%98%E9%87%8F%E5%90%8D%E4%B8%BA%E2%80%9Citem%E2%80%9D%0A%20%20%20%20-%20%E8%A6%81%E5%9C%A8task%E4%B8%AD%E4%BD%BF%E7%94%A8with_items%E7%BB%99%E5%AE%9A%E8%A6%81%E8%BF%AD%E4%BB%A3%E7%9A%84%E5%85%83%E7%B4%A0%E5%88%97%E8%A1%A8%0A%20%20%20%20-%20%E5%88%97%E8%A1%A8%E6%A0%BC%E5%BC%8F%EF%BC%9A%0A%20%20%20%20%20%20%20%20%E5%AD%97%E7%AC%A6%E4%B8%B2%0A%20%20%20%20%20%20%20%20%E5%AD%97%E5%85%B8%0A%23%23%23%23%20for%20if%0A%60%60%60%0A%7B%25%20for%20vhost%20in%20nginx_vhosts%20%25%7D%0Aserver%20%7B%0A%20%20%20%20listen%20%7B%7B%20vhost.listen%20%7C%20default('80%20default_server')%20%7D%7D%3B%0A%20%20%20%20%0A%20%20%20%20%7B%25%20if%20vhost.server_name%20is%20defined%20%25%7D%0A%20%20%20%20server_name%20%7B%7B%20vhost.server_name%20%7D%7D%3B%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%20%20%0A%20%20%20%20%7B%25%20if%20vhost.root%20is%20defined%20%25%7D%0A%20%20%20%20root%20%7B%7B%20vhost.root%20%7D%7D%3B%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%7D%0A%7B%25%20endfor%20%25%7D%0A%60%60%60%0A%23%23%20roles%0A*%20roles%0A%20%20%20%20ansible%E8%87%AA1.2%E7%89%88%E6%9C%AC%E5%BC%95%E5%85%A5%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%B1%82%E6%AC%A1%E6%80%A7%E3%80%81%E7%BB%93%E6%9E%84%E5%8C%96%E5%9C%B0%E7%BB%84%E7%BB%87playbook%E3%80%82roles%E8%83%BD%E5%A4%9F%E6%A0%B9%E6%8D%AE%E5%B1%82%E6%AC%A1%E5%9E%8B%E7%BB%93%E6%9E%84%E8%87%AA%E5%8A%A8%E8%A3%85%E8%BD%BD%E5%8F%98%E9%87%8F%E6%96%87%E4%BB%B6%E3%80%81tasks%E4%BB%A5%E5%8F%8Ahandlers%E7%AD%89%E3%80%82%E8%A6%81%E4%BD%BF%E7%94%A8roles%E5%8F%AA%E9%9C%80%E8%A6%81%E5%9C%A8playbook%E4%B8%AD%E4%BD%BF%E7%94%A8include%E6%8C%87%E4%BB%A4%E5%8D%B3%E5%8F%AF%E3%80%82%E7%AE%80%E5%8D%95%E6%9D%A5%E8%AE%B2%EF%BC%8Croles%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87%E5%88%86%E5%88%AB%E5%B0%86%E5%8F%98%E9%87%8F%E3%80%81%E6%96%87%E4%BB%B6%E3%80%81%E4%BB%BB%E5%8A%A1%E3%80%81%E6%A8%A1%E6%9D%BF%E5%8F%8A%E5%A4%84%E7%90%86%E5%99%A8%E6%94%BE%E7%BD%AE%E4%BA%8E%E5%8D%95%E7%8B%AC%E7%9B%AE%E5%BD%95%E4%B8%AD%EF%BC%8C%E5%B9%B6%E5%8F%AF%E4%BB%A5%E4%BE%BF%E6%8D%B7%E5%9C%B0include%E5%AE%83%E4%BB%AC%E7%9A%84%E4%B8%80%E7%A7%8D%E6%9C%BA%E5%88%B6%E3%80%82%E8%A7%92%E8%89%B2%E4%B8%80%E8%88%AC%E7%94%A8%E4%BA%8E%E5%9F%BA%E4%BA%8E%E4%B8%BB%E6%9C%BA%E6%9E%84%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%9C%BA%E6%99%AF%E4%B8%AD%EF%BC%8C%E4%BD%86%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%98%AF%E7%94%A8%E4%BA%8E%E6%9E%84%E5%BB%BA%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E7%AD%89%E5%9C%BA%E6%99%AF%E4%B8%AD%E3%80%82%0A*%20%E5%A4%8D%E6%9D%82%E5%9C%BA%E6%99%AF%EF%BC%9A%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8roles%EF%BC%8C%E4%BB%A3%E7%A0%81%E5%88%A9%E7%94%A8%E5%BA%A6%E9%AB%98%0A%20%20%20%20-%20%E5%8F%98%E6%9B%B4%E6%8C%87%E5%AE%9A%E4%B8%BB%E6%9C%BA%E6%88%96%E4%B8%BB%E6%9C%BA%E7%BB%84%0A%20%20%20%20-%20%E5%A6%82%E5%91%BD%E5%90%8D%E4%B8%8D%E8%A7%84%E8%8C%83%E7%BB%B4%E6%8A%A4%E5%92%8C%E4%BC%A0%E6%89%BF%E6%88%90%E6%9C%AC%E5%A4%A7%0A%20%20%20%20-%20%E6%9F%90%E4%BA%9B%E5%8A%9F%E8%83%BD%E9%9C%80%E5%A4%9A%E4%B8%AAplaybook%EF%BC%8C%E9%80%9A%E8%BF%87includes%E5%8D%B3%E5%8F%AF%E5%AE%9E%E7%8E%B0%0A*%20roles%E5%90%84%E7%9B%AE%E5%BD%95%E4%BD%9C%E7%94%A8%0A%20%20%20%20%2Froles%2Fproject%2F%EF%BC%9A%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0%EF%BC%8C%E6%9C%89%E4%BB%A5%E4%B8%8B%E5%AD%90%E7%9B%AE%E5%BD%95%0A%20%20%20%20%20%20%20%20-%20files%2F%EF%BC%9A%E5%AD%98%E6%94%BE%E7%94%B1copy%E6%88%96script%E6%A8%A1%E5%9D%97%E8%B0%83%E7%94%A8%E7%9A%84%E6%96%87%E4%BB%B6%0A%20%20%20%20%20%20%20%20-%20templates%2F%EF%BC%9Atemplate%E6%A8%A1%E5%9D%97%E6%9F%A5%E6%89%BE%E6%89%80%E9%9C%80%E8%A6%81%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%AE%E5%BD%95%0A%20%20%20%20%20%20%20%20-%20tasks%2F%EF%BC%9A%E5%AE%9A%E4%B9%89task%2C%20role%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0%EF%BC%8C%E8%87%B3%E5%B0%91%E5%BA%94%E8%AF%A5%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAmain.yml%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%9B%E5%85%B6%E5%AE%83%E7%9A%84%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E5%9C%A8%E6%AD%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%80%9A%E8%BF%87include%E8%BF%9B%E8%A1%8C%E5%8C%85%E5%90%AB%0A%20%20%20%20%20%20%20%20-%20handlers%2F%EF%BC%9A%E8%87%B3%E5%B0%91%E5%BA%94%E8%AF%A5%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAmain.yml%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%9B%E5%85%B6%E5%AE%83%E7%9A%84%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E5%9C%A8%E4%BA%9B%E6%96%87%E4%BB%B6%E4%B8%AD%E9%80%9A%E8%BF%87include%E8%BF%9B%E8%A1%8C%E5%8C%85%E5%90%AB%0A%20%20%20%20%20%20%20%20-%20vars%2F%EF%BC%9A%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%EF%BC%8C%E8%87%B3%E5%B0%91%E5%BA%94%E8%AF%A5%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAmain.yml%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%9B%E5%85%B6%E5%AE%83%E7%9A%84%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E5%9C%A8%E6%AD%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%80%9A%E8%BF%87include%E8%BF%9B%E8%A1%8C%E5%8C%85%E5%90%AB%0A%20%20%20%20%20%20%20%20-%20meta%2F%EF%BC%9A%E5%AE%9A%E4%B9%89%E5%BD%93%E5%89%8D%E8%A7%92%E8%89%B2%E7%9A%84%E7%89%B9%E6%AE%8A%E8%AE%BE%E5%AE%9A%E5%8F%8A%E5%85%B6%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%EF%BC%8C%E8%87%B3%E5%B0%91%E5%BA%94%E8%AF%A5%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAmain.yml%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E5%85%B6%E5%AE%83%E6%96%87%E4%BB%B6%E9%9C%80%E5%9C%A8%E6%AD%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%80%9A%E8%BF%87include%E8%BF%9B%E8%A1%8C%E5%8C%85%E5%90%AB%0A%20%20%20%20%20%20%20%20-%20default%2F%EF%BC%9A%E8%AE%BE%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%8F%98%E9%87%8F%E6%97%B6%E4%BD%BF%E7%94%A8%E6%AD%A4%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84main.yml%E6%96%87%E4%BB%B6%0A%23%23%23%20%E8%BF%90%E8%A1%8Cplaybook%0A*%20%E8%BF%90%E8%A1%8Cplaybook%E6%96%B9%E5%BC%8F%0A%60%60%60%0Aansible-playbook%20%3Cfilename.yml%3E%20...%20%5Boptions%5D%0A%60%60%60%0A*%20%E5%B8%B8%E8%A7%81%E9%80%89%E9%A1%B9%0A%20%20%20%20--check%20%20%20%20%20%20%20%20%E5%8F%AA%E6%A3%80%E6%B5%8B%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%8F%91%E7%94%9F%E7%9A%84%E6%94%B9%E5%8F%98%EF%BC%8C%E4%BD%86%E4%B8%8D%E7%9C%9F%E6%AD%A3%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9C%0A%20%20%20%20--list-hosts%20%20%20%E5%88%97%E5%87%BA%E8%BF%90%E8%A1%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%B8%BB%E6%9C%BA%0A%20%20%20%20--limit%20%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%20%20%20%20%E5%8F%AA%E9%92%88%E5%AF%B9%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8%E4%B8%AD%E7%9A%84%E4%B8%BB%E6%9C%BA%E6%89%A7%E8%A1%8C%0A%20%20%20%20-v%20%20%20%20%E6%98%BE%E7%A4%BA%E8%BF%87%E7%A8%8B%20%20%20%20-vv%20-vvv%20%20%20%20%E6%9B%B4%E8%AF%A6%E7%BB%86%0A*%20%E7%A4%BA%E4%BE%8B%0A%20%20%20%20ansible-playbook%20file.yml%20--check%0A%20%20%20%20ansible-playbook%20file.yml%0A%20%20%20%20ansible-playbook%20file.yml%20--limit%20websrvs%0A%20%20%20%20</center></span>
</div></body></html> 