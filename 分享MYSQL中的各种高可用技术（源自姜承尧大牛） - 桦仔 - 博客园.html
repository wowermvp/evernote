<html>
<head>
  <title>分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="738"/>
<h1>分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园</h1>

<div>
<span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="font-size:14px;"><div style="word-break:break-word;"><h1 style="margin:0px;padding:0px;color:rgb(0, 0, 0);font-size:28px;font-weight:bold;text-align:center;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;">分享MYSQL中的各种高可用技术（源自姜承尧大牛）</span></h1><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">图片和资料来源于MYSQL大牛姜承尧老师（</span><a href="http://baike.baidu.com/view/5101249.htm?fr=aladdin" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank" title="http://baike.baidu.com/view/5101249.htm?fr=aladdin">MYSQL技术内幕作者</a><span style="color: rgb(51, 51, 51);">）</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">姜承尧： 网易杭州研究院 技术经理 主导INNOSQL的开发</span></span></p><h1 style="margin:0px;padding:0px;color:rgb(0, 0, 0);font-size:28px;font-weight:bold;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;">mysql高可用各个技术的比较</span></h1><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">数据库的可靠指的是数据可靠 </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">数据库可用指的是数据库服务可用</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><strong style="margin:0px;padding:0px;">可靠的是数据</strong>：例如工商银行，数据不能丢失</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><strong style="margin:0px;padding:0px;">可用的是服务</strong>：服务器不能宕机</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112209189103320.jpg" type="image/jpeg" data-filename="112209189103320.jpg" height="496" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="697"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">灵活运用MYSQL的各种高可用技术来达到下面各种级别的高可用要求</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">要达到99.9%：使用MYSQL复制技术</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">要达到99.99%：使用MYSQL NDB 集群和虚拟化技术</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">要达到99.999%：使用shared-nothing架构的GEO-REPLICATION和NDB集群技术</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff0000;"><strong style="margin:0px;padding:0px;">Gluster Geo-replication是什麼？</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">Gluster Geo-replication(简称geo-replication)是一种异地灾备技术，</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">它主要应用于把集群中的一个存储，近乎即时地(near real-time)透过公网（wan）备份到远端的机房</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/120951047853105.jpg" type="image/jpeg" data-filename="120951047853105.jpg" height="518" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="717"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">各种高可用级别允许的宕机时间</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/120956571148401.jpg" type="image/jpeg" data-filename="120956571148401.jpg" height="304" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="382"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">DRBD：网络磁盘的RAID1</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/121001021927962.jpg" type="image/jpeg" data-filename="121001021927962.jpg" height="389" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="696"/></span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案一：MYSQL主从复制（单活）</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112220021292314.jpg" type="image/jpeg" data-filename="112220021292314.jpg" height="449" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="634"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">投票选举机制，较复杂</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">MySQL本身没有提供replication failover的解决方案，自动切换需要依赖</span><a href="http://os.51cto.com/art/201307/401702.htm" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank" title="http://os.51cto.com/art/201307/401702.htm">MHA脚本</a></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">可以有多台从库，从库可以做报表和备份</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> <img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112247213641053.jpg" type="image/jpeg" data-filename="112247213641053.jpg" height="560" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="790"/></span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案二：双主（单活），failover比单主简单</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112233058013131.jpg" type="image/jpeg" data-filename="112233058013131.jpg" height="541" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="740"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">同样，自动切换需要</span><a href="http://blog.chinaunix.net/uid-20639775-id-3337488.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank" title="http://blog.chinaunix.net/uid-20639775-id-3337488.html">MMM脚本</a></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">缺点是某个主挂掉了，他下面的slave同样挂掉</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112248208326350.jpg" type="image/jpeg" data-filename="112248208326350.jpg" height="452" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="721"/></span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案三：双主配SAN存储（单活）</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112234354266450.jpg" type="image/jpeg" data-filename="112234354266450.jpg" height="559" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="766"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">这个架构跟方案二是一样的，只不过两个master之间不需要同步数据，因为他们用的是共享磁盘</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">这个方案是</span><span style="margin:0px;padding:0px;color:#ff0000;font-size:16px;"><strong style="margin:0px;padding:0px;">有钱人方案</strong></span><span style="color: rgb(51, 51, 51);">，无论哪个主挂掉都不会引起其他的slave挂掉，但是SAN存储死贵。。</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">像通信行业中国联通这些公司有用到</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">某个主挂掉了，下面的slave不会挂掉</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">注意：failover之后不会预热，数据没有预先加载到内存中，切换之后一段时间内存储会有一定的性能影响</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> <img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112251318328465.jpg" type="image/jpeg" data-filename="112251318328465.jpg" height="458" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="705"/></span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案四：DRBD <strong style="margin:0px;padding:0px;">双主配<strong style="margin:0px;padding:0px;">DRBD </strong>（单活）</strong></strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112239143322442.jpg" type="image/jpeg" data-filename="112239143322442.jpg" height="572" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="849"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">结构跟方案三一样，唯一不同的是没有使用SAN网络存储 ，而是使用<strong style="margin:0px;padding:0px;">local disk</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">由于是实时复制磁盘数据，性能会有影响</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">人们把DRBD称为</span><span style="margin:0px;padding:0px;font-size:16px;color:#ff0000;"><strong style="margin:0px;padding:0px;">“屌丝的SAN”</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;font-size:16px;color:#ff0000;"><strong style="margin:0px;padding:0px;">POOR MAN'S SAN：穷人的SAN</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> <img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112243567857817.jpg" type="image/jpeg" data-filename="112243567857817.jpg" height="449" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="699"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案五：NDB CLUSTER</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> <img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112307549899406.jpg" type="image/jpeg" data-filename="112307549899406.jpg" height="520" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="747"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">国内用NDB集群的公司非常少，貌似有些银行有用</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">NDB集群不需要依赖第三方组件，全部都使用官方组件，能保证数据的一致性</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">某个数据节点挂掉，其他数据节点依然可以提供服务</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">管理节点需要做冗余以防挂掉</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">缺点是：管理和配置都很复杂，而且某些SQL语句例如join语句需要避免</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112308221459243.jpg" type="image/jpeg" data-filename="112308221459243.jpg" height="433" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="772"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112308522398049.jpg" type="image/jpeg" data-filename="112308522398049.jpg" height="430" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="738"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案六：第三方的Tungsten软件</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112313226145749.jpg" type="image/jpeg" data-filename="112313226145749.jpg" height="530" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="796"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">使用java编写，不是MYSQL内置的</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">同样是MYSQL数据库复制，不过他不是用MYSQL内置的组件来做的</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">不但支持MYSQL数据库复制也支持异构数据库的复制，而且对异构数据库复制支持较好，例如MYSQL复制到ORACLE</span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">方案七：网易的INNOSQL</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">类似于SQLSERVER的</span><a href="http://blogs.msdn.com/b/apgcdsd/archive/2012/10/19/sql-server-image.aspx" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank" title="http://blogs.msdn.com/b/apgcdsd/archive/2012/10/19/sql-server-image.aspx">镜像高安全模式</a></span></p><blockquote style="margin:0px;background:none;border:2px solid rgb(239, 239, 239);padding:5px 10px;margin-top:10px;margin-bottom:10px;"><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">High Safety 模式 （也就是同步模式）没有 witness服务器</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">数据库在Principle的事务，<span style="margin:0px;padding:0px;text-decoration:underline;"><strong style="margin:0px;padding:0px;">需要马上得到mirror的确认，才能完成</strong></span>。这种情况下，Mirror和Principle的数据是同步的。</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">但是因为所有的事务需要mirror的确认，所以性能可能会有所影响。</span></span></p></blockquote><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">区别：innosql的slave可以读，镜像的slave（从库）不可读</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">保证数据不会丢失，数据的高可靠性</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">mysql5.7开始支持这种模式</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"><img src="分享MYSQL中的各种高可用技术（源自姜承尧大牛） - 桦仔 - 博客园_files/112329447395404.jpg" type="image/jpeg" data-filename="112329447395404.jpg" height="514" style="margin: 0px; padding: 0px; border: 0px; height: auto; max-width: 300px;" width="800"/></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></p><hr style="margin:0px;padding:0px;"/><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="margin:0px;padding:0px;color:#ff9900;"><strong style="margin:0px;padding:0px;">总结</strong></span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">每种方案都有不同的特点，配置和应用场景也各有不同</span></span></p><p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">有些偏向于成本低的，有些偏向于成本高的，有些偏向于数据的可靠性，有些则偏向于数据库的可用性</span></span></p><div style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><div><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);">反正各个方案都各有优缺点，DBA要结合自己公司的业务情况进行选择合适自己业务情况的高可用方案</span></span></div></div><div style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><div><span style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><span style="color: rgb(51, 51, 51);"> </span></span></div></div></div></div></div><br/></div></span>
</div></body></html> 