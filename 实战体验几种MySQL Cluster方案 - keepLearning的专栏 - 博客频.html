<html>
<head>
  <title>实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频道 - CSDN.NET</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="697"/>
<h1>实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频道 - CSDN.NET</h1>

<div>
<span><div style="-evernote-webclip:true"><br/><div style="display: inline-block;"><div style="background-image: url(http://static.blog.csdn.net/skin/default/images/body_bg.gif); text-align: center; background-position: 0px 20px; background-repeat: repeat no-repeat;"><div style="background:url(&quot;http://static.blog.csdn.net/skin/default/css/../images/head_bg.jpg&quot;) center top no-repeat;"><div style="overflow:hidden;background:rgb(255, 255, 255);border-radius:8px;text-align:left;"><div style="overflow:hidden;border-radius:4px;"><div style="display:block;margin:5px 0px;color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:20px;font-family:&quot;Microsoft YaHei&quot;;"><h1 style="font-size:20px;padding:0px;margin:0px;font-weight:normal;font-stretch:normal;font-style:normal;font-family:&quot;Microsoft YaHei&quot;;vertical-align:middle;font-variant:normal;display:inline;"><a href="http://blog.csdn.net/kingofworld/article/details/44786123" style="text-decoration:none;color:rgb(0, 0, 0);">实战体验几种MySQL Cluster方案</a></h1><span style="color:rgb(0, 0, 0);font-style:normal;font-variant:normal;font-weight:normal;font-size:20px;font-family:&quot;Microsoft YaHei&quot;;display:block;height:0px;clear:both;visibility:hidden;">.</span></div><div style="padding:0px 20px 5px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;color:rgb(153, 153, 153);font-family:Arial;text-align:right;display:block;border-bottom:1px solid rgb(237, 237, 237);margin:0px -20px;overflow:hidden;"><div style="width:100%;float:left;"><span style="margin:0px 5px;float:left;">标签： <a href="http://www.csdn.net/tag/mysql" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">mysql</a><a href="http://www.csdn.net/tag/fabric" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">fabric</a><a href="http://www.csdn.net/tag/galera" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">galera</a><a href="http://www.csdn.net/tag/%e5%8f%af%e6%89%a9%e5%b1%95" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">可扩展</a><a href="http://www.csdn.net/tag/%e9%9b%86%e7%be%a4" style="color:rgb(51, 102, 153);text-decoration:none;display:inline-block;margin-right:10px;" target="_blank">集群</a></span></div><div><span style="margin:0px 5px 0px 0px;">2015-03-31 22:02</span> <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://static.blog.csdn.net/css/../../../images/ico_view.png&quot;) left center no-repeat;" title="阅读次数">2298人阅读</span> <span style="margin:0px 5px;padding:0px 0px 0px 14px;background:url(&quot;http://static.blog.csdn.net/css/../../../images/ico_comm.png&quot;) left center no-repeat;" title="评论次数"><a href="http://blog.csdn.net/kingofworld/article/details/44786123#comments" style="color:rgb(51, 102, 153);text-decoration:none;">评论</a>(1)</span> <span style="margin:0px 5px;"><a href="#" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank" title="收藏">收藏</a></span> <span style="margin:0px 5px;"><a href="http://blog.csdn.net/kingofworld/article/details/44786123#report" style="color:rgb(51, 102, 153);text-decoration:none;" title="举报">举报</a></span></div><span style="color:rgb(153, 153, 153);font-style:normal;font-variant:normal;font-weight:normal;font-size:12px;font-family:Arial;text-align:right;display:block;height:0px;clear:both;visibility:hidden;">.</span></div><div style="display:block;margin:0px -20px;border-bottom:1px solid rgb(237, 237, 237);padding:5px 20px;margin-left:0px;"><div style="display:inline-block;font-size:14px;color:rgb(51, 51, 51);width:70px;float:left;"><span style="font-family: Arial, Console, Verdana, 'Courier New';"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/category_icon.jpg" type="image/jpeg" data-filename="category_icon.jpg" height="13" style="border: none; vertical-align: middle; height: auto;" width="15"/> <span style="display:inline-block;vertical-align:middle;">分类：</span></span></div><div style="display:inline-block;font-size:14px;color:rgb(223, 52, 52);float:left;width:90%;"><span style="font-family: Arial, Console, Verdana, 'Courier New';"><span style="display:inline-block;margin-left:15px;cursor:pointer;position:relative;">数据库<em style="font-style:normal;">（9）</em> <img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/arrow_triangle _down.jpg" type="image/jpeg" data-filename="arrow_triangle _down.jpg" height="5" style="border: none; display: inline; height: auto;" width="10"/></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Arial, Console, Verdana, 'Courier New';"><span style="color: rgb(51, 51, 51);"><span style="display:block;height:0px;clear:both;visibility:hidden;">.</span></span></span></span></div></div><div style="margin:20px 0px 0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:14px;font-family:Arial;"><h2 style="margin:0px;padding:0px;"><a name="t0" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">1.背景</span></h2><p><a href="http://lib.csdn.net/base/mysql" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="MySQL知识库">MySQL</a><span style="color: rgb(51, 51, 51);">的cluster方案有很多官方和第三方的选择，选择多就是一种烦恼，因此，我们考虑MySQL</span><a href="http://lib.csdn.net/base/mysql" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="MySQL知识库">数据库</a><span style="color: rgb(51, 51, 51);">满足下三点需求，考察市面上可行的解决方案：</span></p><ul><li><span style="color: rgb(51, 51, 51);">高可用性：主服务器故障后可自动切换到后备服务器</span></li><li><span style="color: rgb(51, 51, 51);">可伸缩性：可方便通过脚本增加DB服务器</span></li><li><span style="color: rgb(51, 51, 51);">负载均衡：支持手动把某公司的数据请求切换到另外的服务器，可配置哪些公司的数据服务访问哪个服务器</span></li></ul><p><span style="color: rgb(51, 51, 51);"> 需要选用一种方案满足以上需求。在MySQL官方网站上参考了几种解决方案的优缺点：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center.png" type="image/png" data-filename="Center.png" height="346" style="border: none; max-width: 100%; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);">综合考虑，决定采用MySQL Fabric和MySQL Cluster方案，以及另外一种较成熟的集群方案Galera Cluster进行预研。</span></p><p><span style="color: rgb(51, 51, 51);"> </span></p><h2 style="margin:0px;padding:0px;"><a name="t1" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">2.MySQLCluster</span></h2><p><span style="color: rgb(51, 51, 51);"><strong>简介：</strong></span></p><p><span style="color: rgb(51, 51, 51);">MySQL Cluster 是MySQL 官方集群部署方案，它的历史较久。支持通过自动分片支持读写扩展，通过实时备份冗余数据，是可用性最高的方案，声称可做到99.999%的可用性。</span></p><p><span style="color: rgb(51, 51, 51);"> <span style="font-weight:bold;font-size:12px;"><a href="http://lib.csdn.net/base/architecture" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="大型网站架构知识库">架构</a>及实现原理：</span></span></p><p><span style="color: rgb(51, 51, 51);"><strong><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [1].png" type="image/png" data-filename="Center.png" height="364" style="border: none; max-width: 100%; height: auto;" width="566"/><br/></strong></span></p><p><span style="color: rgb(51, 51, 51);">MySQL cluster<span style="font-family:宋体;">主要由三种类型的服务组成：</span></span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">NDB Management Server</span><span style="font-size:12px;font-family:宋体;">：管理服务器主要用于管理</span><span style="font-size:12px;font-family:'Times New Roman';">cluster</span><span style="font-size:12px;font-family:宋体;">中的其他类型节点（</span><span style="font-size:12px;font-family:'Times New Roman';">Data Node</span><span style="font-size:12px;font-family:宋体;">和</span><span style="font-size:12px;font-family:'Times New Roman';">SQL Node</span><span style="font-size:12px;font-family:宋体;">），通过它可以配置</span><span style="font-size:12px;font-family:'Times New Roman';">Node</span><span style="font-size:12px;font-family:宋体;">信息，启动和停止</span><span style="font-size:12px;font-family:'Times New Roman';">Node</span><span style="font-size:12px;font-family:宋体;">。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;"> SQL Node</span><span style="font-size:12px;font-family:宋体;">：在</span><span style="font-size:12px;font-family:'Times New Roman';">MySQL Cluster</span><span style="font-size:12px;font-family:宋体;">中，一个</span><span style="font-size:12px;font-family:'Times New Roman';">SQL Node</span><span style="font-size:12px;font-family:宋体;">就是一个使用</span><span style="font-size:12px;font-family:'Times New Roman';">NDB</span><span style="font-size:12px;font-family:宋体;">引擎的</span><span style="font-size:12px;font-family:'Times New Roman';">mysql server</span><span style="font-size:12px;font-family:宋体;">进程，用于供外部应用提供集群数据的访问入口。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">Data Node</span><span style="font-size:12px;font-family:宋体;">：用于存储集群数据；系统会尽量将数据放在内存中。</span></span></li></ul><p><span style="color: rgb(51, 51, 51);"><strong><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [2].png" type="image/png" data-filename="Center.png" height="385" style="border: none; max-width: 100%; height: auto;" width="619"/><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [3].png" type="image/png" data-filename="Center.png" height="445" style="border: none; max-width: 100%; height: auto;" width="672"/><br/></strong></span></p><p><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">缺点及限制：</span></span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">对需要进行分片的表需要修改引擎Innodb为NDB，不需要分片的可以不修改。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">NDB的事务隔离级别只支持Read Committed，即一个事务在提交前，查询不到在事务内所做的修改；而Innodb支持所有的事务隔离级别，默认使用Repeatable Read，不存在这个问题。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">外键支持：虽然最新的Cluster版本已经支持外键，但性能有问题（因为外键所关联的记录可能在别的分片节点中），所以建议去掉所有外键。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">Data Node节点数据会被尽量放在内存中，对内存要求大。</span></span></li></ul><p><span style="color: rgb(51, 51, 51);">数据库系统提供了四种事务隔离级别：<br/>
A.Serializable（串行化）：一个事务在执行过程中完全看不到其他事务对数据库所做的更新（事务执行的时候不允许别的事务并发执行。事务串行化执行，事务只能一个接着一个地执行，而不能并发执行。）。<br/>
B.Repeatable Read（可重复读）：一个事务在执行过程中可以看到其他事务已经提交的新插入的记录，但是不能看到其他其他事务对已有记录的更新。<br/>
C.Read Commited（读已提交数据）：一个事务在执行过程中可以看到其他事务已经提交的新插入的记录，而且能看到其他事务已经提交的对已有记录的更新。<br/>
D.Read Uncommitted（读未提交数据）：一个事务在执行过程中可以看到其他事务没有提交的新插入的记录，而且能看到其他事务没有提交的对已有记录的更新。</span></p><h2 style="margin:0px;padding:0px;"><a name="t2" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">3.MySQL Fabric</span></h2><p><span style="color: rgb(51, 51, 51);">简介：</span></p><p><span style="color:rgb(51,51,51);">为了实现和方便管理MySQL 分片以及实现高可用部署，</span><a href="http://lib.csdn.net/base/oracle" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="Oracle知识库">Oracle</a><span style="color: rgb(51, 51, 51);"><span style="font-family:宋体;">在</span>2014年<span style="font-family:Times New Roman;">5</span><span style="font-family:宋体;">月推出了一套为各方寄予厚望的</span><span style="font-family:Times New Roman;">MySQL</span><span style="font-family:宋体;">产品 </span><span style="font-family:Times New Roman;">-- MySQL Fabric</span>, 用来管理<span style="font-family:Times New Roman;">MySQL </span><span style="font-family:宋体;">服务，提供扩展性和容易使用的系统，</span><span style="font-family:Times New Roman;">Fabric</span><span style="font-family:宋体;">当前实现了两个特性：高可用和使用数据分片</span>实现可扩展性和负载均衡，这两个特性能单独使用或结合使用。</span></p><p><span style="color: rgb(51, 51, 51);">MySQL Fabric 使用了一系列的<span style="font-family:Times New Roman;"><a href="http://lib.csdn.net/base/python" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="Python知识库">Python</a></span><span style="font-family:宋体;">脚本实现。</span></span></p><p><span style="color: rgb(51, 51, 51);">应用案例：由于该方案在去年才推出，目前在网上暂时没搜索到有大公司的应用案例。</span></p><p><span style="color: rgb(51, 51, 51);">架构及实现原理：</span></p><p><span style="color: rgb(51, 51, 51);">Fabric支持实现高可用性的架构图如下：</span></p><span style="color: rgb(51, 51, 51);"><br/><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [4].png" type="image/png" data-filename="Center.png" height="388" style="border: none; max-width: 100%; font-size: 12px; height: auto;" width="389"/></span><p><span style="color: rgb(51, 51, 51);">Fabric使用HA组实现高可用性，其中一台是主服务器，其他是备份服务器， 备份服务器通过同步复制实现数据冗余。应用程序使用特定的驱动，连接到Fabric 的Connector组件，当主服务器发生故障后，Connector自动升级其中一个备份服务器为主服务器，应用程序无需修改。<br/><br/>
Fabric支持可扩展性及负载均衡的架构如下：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [5].png" type="image/png" data-filename="Center.png" height="269" style="border: none; max-width: 100%; font-size: 12px; height: auto;" width="516"/></span></p><p><span style="color: rgb(51, 51, 51);"><br/></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [6].png" type="image/png" data-filename="Center.png" height="300" style="border: none; max-width: 100%; font-size: 12px; height: auto;" width="509"/></span></p><p><span style="color: rgb(51, 51, 51);">使用多个HA 组实现分片，每个组之间分担不同的分片数据（组内的数据是冗余的，这个在高可用性中已经提到）<br/>
应用程序只需向connector发送query和insert等语句，Connector通过MasterGroup自动分配这些数据到各个组，或从各个组中组合符合条件的数据，返回给应用程序。<br/><br/>
缺点及限制：<br/>
影响比较大的两个限制是：</span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">自增长键不能作为分片的键；</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">事务及查询只支持在同一个分片内，事务中更新的数据不能跨分片，查询语句返回的数据也不能跨分片。</span></span></li></ul><span style="color: rgb(51, 51, 51);"><br/></span><p><span style="color: rgb(51, 51, 51);"><br/></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [7].png" type="image/png" data-filename="Center.png" height="377" style="border: none; max-width: 100%; font-size: 12px; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);"><strong>测试高可用性</strong></span></p><p><span style="color: rgb(51, 51, 51);">服务器架构：</span></p><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;"><tbody><tr><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">功能</span></p></td><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">IP</span></p></td><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">Port</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">Backing store(<span style="font-family:宋体;">保存各服务器配置信息</span><span style="font-family:Times New Roman;">)</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.24</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">Fabric <span style="font-family:宋体;">管理进程（</span><span style="font-family:Times New Roman;">Connector</span><span style="font-family:宋体;">）</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.24</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">32274</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">HA Group 1 -- Master</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.23</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">HA Group 1 -- Slave</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.25</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr></tbody></table><p><span style="color: rgb(51, 51, 51);">安装过程省略，下面讲述如何设置高可用组、添加备份服务器等过程</span></p><p><span style="color: rgb(51, 51, 51);">首先，创建高可用组，例如组名group_id-1，命令：</span></p><p><span style="color: rgb(51, 51, 51);">mysqlfabric group create group_id-1</span></p><p><span style="color: rgb(51, 51, 51);">往组内group_id-1添加机器200.200.168.25和200.200.168.23：</span></p><p><span style="color: rgb(51, 51, 51);">mysqlfabric group add group_id-1 200.200.168.25:3306</span></p><p><span style="color: rgb(51, 51, 51);">mysqlfabric group add group_id-1 200.200.168.23:3306</span></p><p><span style="color: rgb(51, 51, 51);">然后查看组内机器状态：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [8].png" type="image/png" data-filename="Center.png" height="139" style="border: none; max-width: 100%; height: auto;" width="597"/></span></p><p><span style="color: rgb(51, 51, 51);">由于未设置主服务器，两个服务的状态都是SECONDARY<br/>
提升其中一个为主服务器：<br/>
mysqlfabric group promote group_id-1 --slave_id 00f9831f-d602-11e3-b65e-0800271119cb<br/>
然后再查看状态：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [9].png" type="image/png" data-filename="Center.png" height="135" style="border: none; max-width: 100%; height: auto;" width="596"/></span></p><p><span style="color: rgb(51, 51, 51);">设置成主服务器的服务已经变成Primary。<br/>
另外，mode属性表示该服务器是可读写（READ_WRITE)，或只读(READ_ONLY)，只读表示可以分摊查询数据的压力；只有主服务器能设置成可读写（READ_WRITE)。<br/>
这时检查25服务器的slave状态：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [10].png" type="image/png" data-filename="Center.png" height="335" style="border: none; max-width: 100%; height: auto;" width="448"/></span></p><p><span style="color: rgb(51, 51, 51);">可以看到它的主服务器已经指向23<br/><br/><br/>
然后激活故障自动切换功能：<br/>
mysqlfabric group activate group_id-1<br/>
激活后即可测试服务的高可以性<br/>
首先，进行状态测试：<br/>
停止主服务器23</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [11].png" type="image/png" data-filename="Center.png" height="41" style="border: none; max-width: 100%; height: auto;" width="484"/></span></p><p><span style="color: rgb(51, 51, 51);">然后查看状态：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [12].png" type="image/png" data-filename="Center.png" height="138" style="border: none; max-width: 100%; height: auto;" width="588"/></span></p><p><span style="color: rgb(51, 51, 51);">可以看到，这时将25自动提升为主服务器。<br/>
但如果将23恢复起来后，需要手动重新设置23为主服务器。<br/><br/><br/><strong>实时性测试：</strong><br/>
目的：测试在主服务更新数据后，备份服务器多久才显示这些数据<br/>
测试案例：使用</span><a href="http://lib.csdn.net/base/javaee" style="color:#df3434;text-decoration:none;font-weight:bold;" target="_blank" title="Java EE知识库">Java</a><span style="color: rgb(51, 51, 51);">代码建连接，往某张表插入100条记录，看备份服务器多久才能同步这100条数据<br/>
测试结果：<br/>
表中原来有101条数据，运行程序后，查看主服务器的数据条数：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [13].png" type="image/png" data-filename="Center.png" height="262" style="border: none; max-width: 100%; height: auto;" width="317"/></span></p><p><span style="color: rgb(51, 51, 51);">可见主服务器当然立即得到更新。<br/><br/>
查看备份服务器的数据条数：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [14].png" type="image/png" data-filename="Center.png" height="496" style="border: none; max-width: 100%; height: auto;" width="290"/></span></p><p><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">但备份服务器等待了1-2分钟才同步完成（可以看到fabric使用的是异步复制，这是默认方式，性能较好，主服务器不用等待备份服务器返回，但同步速度较慢）</span></span></p><p><span style="color: rgb(51, 51, 51);"><br/>
对于从服务器同步数据稳定性问题，有以下解决方案：</span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">使用半同步加强数据一致性：异步复制能提供较好的性能，但主库只是把binlog日志发送给从库，动作就结束了，不会验证从库是否接收完毕，风险较高。半同步复制会在发送给从库后，等待从库发送确认信息后才返回。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">可以设置从库中同步日志的更新方式，从而减少从库同步的延迟，加快同步速度。</span></span></li></ul><span style="color: rgb(51, 51, 51);">安装半同步复制：<br/>
在mysql中运行<br/>
install plugin rpl_semi_sync_master soname 'semisync_master.so';<br/>
install plugin rpl_semi_sync_slave soname 'semisync_slave.so';<br/>
SET GLOBAL rpl_semi_sync_master_enabled=ON;<br/>
SET GLOBAL rpl_semi_sync_slave_enabled=ON;<br/>
修改my.cnf ：<br/>
rpl_semi_sync_master_enabled=1<br/>
rpl_semi_sync_slave_enabled=1<br/>
sync_relay_log=1<br/>
sync_relay_log_info=1<br/>
sync_master_info=1<br/><br/><strong>稳定性测试：</strong><br/>
测试案例：使用java代码建连接，往某张表插入1w条记录，插入过程中将其中的master服务器停了，看备份服务器是否有这1w笔记录<br/>
测试结果，停止主服务器后，java程序抛出异常：</span><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [15].png" type="image/png" data-filename="Center.png" height="403" style="border: none; max-width: 100%; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);">但这时再次发送sql命令，可以成功返回。证明只是当时的事务失败了。连接切换到了备份服务器，仍然可用。<br/>
翻阅了mysql文档，有章节说明了这个问题：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [16].png" type="image/png" data-filename="Center.png" height="125" style="border: none; max-width: 100%; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);">里面提到：当主服务器当机时，我们的应用程序虽然是不需做任何修改的，但在主服务器被备份服务器替换前，某些事务会丢失，这些可以作为正常的mysql错误来处理。<br/><br/><strong>数据完整性校验：</strong><br/>
测试主服务器停止后，备份服务器是否能够同步所有数据。<br/>
重启了刚才停止主服务器后，查看记录数</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [17].png" type="image/png" data-filename="Center.png" height="122" style="border: none; max-width: 100%; height: auto;" width="344"/></span></p><p><span style="color: rgb(51, 51, 51);">可以看到在插入<span style="font-family:Times New Roman;">1059</span><span style="font-family:宋体;">条记录后被停止了。</span></span></p><p><span style="color: rgb(51, 51, 51);">现在看看备份服务器的记录数是多少，看看在主服务器当机后是否所有数据都能同步过来</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [18].png" type="image/png" data-filename="Center.png" height="498" style="border: none; max-width: 100%; height: auto;" width="293"/></span></p><p><span style="color: rgb(51, 51, 51);">大约经过了几十秒，才同步完，数据虽然不是立即同步过来，但没有丢失。</span></p><p><span style="color: rgb(51, 51, 51);"><strong style="font-size:12px;">1.2<span style="font-family:宋体;">、分片：如何支持可扩展性和负载均衡</span></strong></span></p><p><span style="color: rgb(51, 51, 51);">fabric<span style="font-family:宋体;">分片简介：</span>当一台机器或一个组承受不了服务压力后，可以添加服务器分摊读写压力，通过<span style="font-family:Times New Roman;">Fabirc</span><span style="font-family:宋体;">的分片功能可以将某些表中数据分散存储到不同服务器。我们可以设定分配数据存储的规则，通过在表中设置分片</span><span style="font-family:Times New Roman;">key</span><span style="font-family:宋体;">设置分配的规则。另外，有些表的数据可能并不需要分片存储，需要将整张表存储在同一个服务器中，可以将设置一个全局组（</span><span style="font-family:Times New Roman;">Global Group</span><span style="font-family:宋体;">）用于存储这些数据，存储到全局组的数据会自动拷贝到其他所有的分片组中。</span></span></p><span style="color: rgb(51, 51, 51);"><br/></span><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [19].png" type="image/png" data-filename="Center.png" height="300" style="border: none; max-width: 100%; height: auto;" width="509"/></span></p><h2 style="margin:0px;padding:0px;"><a name="t3" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">4.Galera Cluster</span></h2><p><span style="color: rgb(51, 51, 51);">简介：</span></p><p><span style="color: rgb(51, 51, 51);">Galera Cluster<span style="font-family:宋体;">号称是世界上最先进的开源数据库集群方案</span></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [20].png" type="image/png" data-filename="Center.png" height="273" style="border: none; max-width: 100%; height: auto;" width="675"/></span></p><p><span style="color: rgb(51, 51, 51);">主要优点及特性：</span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">真正的多主服务模式：多个服务能同时被读写，不像Fabric那样某些服务只能作备份用</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">同步复制：无延迟复制，不会产生数据丢失</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">热备用：当某台服务器当机后，备用服务器会自动接管，不会产生任何当机时间</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">自动扩展节点：新增服务器时，不需手工复制数据库到新的节点</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">支持InnoDB引擎</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">对应用程序透明：应用程序不需作修改</span></span></li></ul><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [21].png" type="image/png" data-filename="Center.png" height="290" style="border: none; max-width: 100%; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);"><strong>架构及实现原理：</strong><br/>
首先，我们看看传统的基于mysql Replication（复制）的架构图：</span></p><p><span style="color: rgb(51, 51, 51);"><br/></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [22].png" type="image/png" data-filename="Center.png" height="303" style="border: none; max-width: 100%; height: auto;" width="323"/></span></p><p><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">Replication方式是通过启动复制线程从主服务器上拷贝更新日志，让后传送到备份服务器上执行，这种方式存在事务丢失及同步不及时的风险。Fabric以及传统的主从复制都是使用这种实现方式。</span></span></p><p><span style="color: rgb(51, 51, 51);"><br/><br/>
而Galera则采用以下架构保证事务在所有机器的一致性：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [23].png" type="image/png" data-filename="Center.png" height="357" style="border: none; max-width: 100%; height: auto;" width="531"/></span></p><p><span style="color: rgb(51, 51, 51);">客户端通过Galera Load Balancer访问数据库，提交的每个事务都会通过wsrep API 在所有服务器中执行，要不所有服务器都执行成功，要不就所有都回滚，保证所有服务的数据一致性，而且所有服务器同步实时更新。<br/><br/><br/>
缺点及限制：</span></p><ul><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">由于同一个事务需要在集群的多台机器上执行，因此网络传输及并发执行会导致性能上有一定的消耗。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">所有机器上都存储着相同的数据，全冗余。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">若一台机器既作为主服务器，又作为备份服务器，出现乐观锁导致rollback的概率会增大，编写程序时要小心。</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">不支持的SQL：LOCK / UNLOCK TABLES / GET_LOCK(), RELEASE_LOCK()…</span></span></li><li><span style="color: rgb(51, 51, 51);"><span style="font-size:12px;">不支持XA Transaction</span></span></li></ul><span style="color: rgb(51, 51, 51);"><br/>
目前基于Galera Cluster的实现方案有三种：Galera Cluster for MySQL、Percona XtraDB Cluster、MariaDB Galera Cluster。<br/>
我们采用较成熟、应用案例较多的Percona XtraDB Cluster。<br/>
应用案例：<br/>
超过2000多家外国企业使用：</span><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [24].png" type="image/png" data-filename="Center.png" height="404" style="border: none; max-width: 100%; height: auto;" width="708"/></span></p><p><span style="color: rgb(51, 51, 51);">包括：</span></p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [25].png" type="image/png" data-filename="Center.png" height="441" style="border: none; max-width: 100%; height: auto;" width="647"/></span><p><span style="color: rgb(51, 51, 51);"><br/></span></p><p><span style="color: rgb(51, 51, 51);">集群部署架构：</span></p><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;"><tbody><tr><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">功能</span></p></td><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">IP</span></p></td><td style="background:rgb(153,204,0);" valign="top"><p><span style="color: rgb(51, 51, 51);">Port</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">Backing store(<span style="font-family:宋体;">保存各服务器配置信息</span><span style="font-family:Times New Roman;">)</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.24</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">Fabric <span style="font-family:宋体;">管理进程（</span><span style="font-family:Times New Roman;">Connector</span><span style="font-family:宋体;">）</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.24</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">32274</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">HA Master 1</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.24</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">HA Master 2</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.25</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">HA Master 3</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">200.200.168.23</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">3306</span></p></td></tr></tbody></table><p><span style="color: rgb(51, 51, 51);"><strong>4.1<span style="font-family:宋体;">、测试数据同步</span></strong></span></p><p><span style="color: rgb(51, 51, 51);">在机器<span style="font-family:Times New Roman;">24</span><span style="font-family:宋体;">上创建一个表：</span></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [26].png" type="image/png" data-filename="Center.png" height="240" style="border: none; max-width: 100%; height: auto;" width="330"/></span></p><p><span style="color: rgb(51, 51, 51);">立即在25 中查看，可见已被同步创建</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [27].png" type="image/png" data-filename="Center.png" height="135" style="border: none; max-width: 100%; height: auto;" width="216"/></span></p><p><span style="color: rgb(51, 51, 51);">使用<span style="font-family:Times New Roman;">Java</span><span style="font-family:宋体;">代码在</span><span style="font-family:Times New Roman;">24</span><span style="font-family:宋体;">服务器上插入</span><span style="font-family:Times New Roman;">100</span><span style="font-family:宋体;">条记录</span></span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [28].png" type="image/png" data-filename="Center.png" height="367" style="border: none; max-width: 100%; height: auto;" width="496"/></span></p><p><span style="color: rgb(51, 51, 51);">立即在25服务器上查看记录数</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [29].png" type="image/png" data-filename="Center.png" height="119" style="border: none; max-width: 100%; height: auto;" width="293"/></span></p><p><span style="color: rgb(51, 51, 51);">可见数据同步是立即生效的。<br/><br/><strong>4.2、测试添加集群节点</strong><br/>
添加一个集群节点的步骤很简单，只要在新加入的机器上部署好Percona XtraDB Cluster，然后启动，系统将自动将现存集群中的数据同步到新的机器上。<br/><br/>
现在为了测试，先将其中一个节点服务停止：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [30].png" type="image/png" data-filename="Center.png" height="36" style="border: none; max-width: 100%; height: auto;" width="433"/></span></p><p><span style="color: rgb(51, 51, 51);">然后使用java代码在集群上插入100W数据</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [31].png" type="image/png" data-filename="Center.png" height="299" style="border: none; max-width: 100%; height: auto;" width="471"/></span></p><p><span style="color: rgb(51, 51, 51);">查看100w数据的数据库大小：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [32].png" type="image/png" data-filename="Center.png" height="35" style="border: none; max-width: 100%; height: auto;" width="342"/></span></p><p><span style="color: rgb(51, 51, 51);">这时启动另外一个节点，启动时即会自动同步集群的数据：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [33].png" type="image/png" data-filename="Center.png" height="108" style="border: none; max-width: 100%; height: auto;" width="412"/></span></p><p><span style="color: rgb(51, 51, 51);">启动只需20秒左右，查看数据大小一致，查看表记录数，也已经同步过来</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [34].png" type="image/png" data-filename="Center.png" height="111" style="border: none; max-width: 100%; height: auto;" width="291"/></span></p><h2 style="margin:0px;padding:0px;"><a name="t4" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">5.<span style="font-family:黑体;">对比总结</span></span></h2><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;width:1284px;"><tbody><tr><td style="width:8.878504672897195%;" valign="top"></td><td style="width:49.29906542056075%;" valign="top"><p><span style="color: rgb(51, 51, 51);">MySQL Fabric</span></p></td><td style="width:41.1993769470405%;" valign="top"><p><span style="color: rgb(51, 51, 51);">Galera Cluster</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">使用案例</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">2014<span style="font-family:宋体;">年</span><span style="font-family:Times New Roman;">5</span><span style="font-family:宋体;">月才推出，</span>目前在网上暂时没搜索到有大公司的应用案例</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">方案较成熟，外国多家互联网公司使用</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">数据备份的实时性</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">由于使用异步复制，一般延时几十秒，但数据不会丢失。</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">实时同步，数据不会丢失</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">数据冗余</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">使用分片，通过设置分片<span style="font-family:Times New Roman;">key</span><span style="font-family:宋体;">规则可以将同一张表的不同数据分散在多台机器中</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">每个节点全冗余，没有分片</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">高可用性</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">通过<span style="font-family:Times New Roman;">Fabric Connector</span><span style="font-family:宋体;">实现主服务器当机后的自动切换，但由于备份延迟，切换后可能不能立即查询数据</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">使用<span style="font-family:Times New Roman;">HAProxy</span><span style="font-family:宋体;">实现。由于实时同步，切换的可用性更高。</span></span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">可伸缩性</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">添加节点后，需要先手工复制集群数据</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">扩展节点十分方便，启动节点时自动同步集群数据，<span style="font-family:Times New Roman;">100w</span><span style="font-family:宋体;">数据（</span><span style="font-family:Times New Roman;">100M</span><span style="font-family:宋体;">）只需</span><span style="font-family:Times New Roman;">20</span><span style="font-family:宋体;">秒左右</span></span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">负载均衡</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">通过<span style="font-family:Times New Roman;">HASharding</span><span style="font-family:宋体;">实现</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">使用<span style="font-family:Times New Roman;">HAProxy</span><span style="font-family:宋体;">实现负载均衡</span></span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">程序修改</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">需要切换成jdbc:mysql:fabric的<span style="font-family:Times New Roman;">jdbc</span><span style="font-family:宋体;">类和</span><span style="font-family:Times New Roman;">url</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">程序无需修改</span></p></td></tr><tr><td valign="top"><p><span style="color: rgb(51, 51, 51);">性能对比</span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">使用<span style="font-family:Times New Roman;">java</span><span style="font-family:宋体;">直接用</span><span style="font-family:Times New Roman;">jdbc</span><span style="font-family:宋体;">插入</span><span style="font-family:Times New Roman;">100</span><span style="font-family:宋体;">条记录，大概</span><span style="font-family:Times New Roman;">2000+ms</span></span></p></td><td valign="top"><p><span style="color: rgb(51, 51, 51);">跟直接操作<span style="font-family:Times New Roman;">mysql</span><span style="font-family:宋体;">一样，直接用</span><span style="font-family:Times New Roman;">jdbc</span><span style="font-family:宋体;">插入</span><span style="font-family:Times New Roman;">100</span><span style="font-family:宋体;">条记录，大概</span><span style="font-family:Times New Roman;">600ms</span></span></p></td></tr></tbody></table><h2 style="margin:0px;padding:0px;"><a name="t5" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">6.实践应用</span></h2><p><span style="color: rgb(51, 51, 51);">综合考虑上面方案的优缺点，我们比较偏向选择Galera 如果只有两台数据库服务器，考虑采用以下数据库架构实现高可用性、负载均衡和动态扩展：</span></p><span style="color: rgb(51, 51, 51);"><br/></span><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [35].png" type="image/png" data-filename="Center.png" height="327" style="border: none; max-width: 100%; height: auto;" width="511"/></span></p><p><span style="color: rgb(51, 51, 51);"><br/></span></p><p><span style="color: rgb(51, 51, 51);">如果三台机器可以考虑：</span></p><p><span style="color: rgb(51, 51, 51);"><img src="实战体验几种MySQL Cluster方案 - keepLearning的专栏 - 博客频_files/Center [36].png" type="image/png" data-filename="Center.png" height="322" style="border: none; max-width: 100%; height: auto;" width="620"/></span></p><p><span style="color: rgb(51, 51, 51);"><br/></span></p><h2 style="margin:0px;padding:0px;"><a name="t6" style="color:rgb(51, 102, 153);text-decoration:none;"></a><span style="color: rgb(51, 51, 51);">7.参考文档</span></h2><p><span style="color: rgb(51, 51, 51);">MySQL<span style="font-family:宋体;">各种集群解决方案的对比：</span></span><a href="https://www.acquia.com/blog/high-availability-database-tools" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank"><span style="color:rgb(0,0,255);">https://www.acquia.com/blog/high-availability-database-tools</span></a><span style="color: rgb(51, 51, 51);">  </span></p><p><span style="color: rgb(51, 51, 51);">Percona XtraDB Cluster <span style="font-family:宋体;">搭配 </span><span style="font-family:Times New Roman;">HAProxy</span>：</span><a href="http://itindex.net/detail/47688-percona-xtradb-cluster" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank"><span style="color:rgb(0,0,255);">http://itindex.net/detail/47688-percona-xtradb-cluster</span></a></p><p><span style="color: rgb(51, 51, 51);">MySQL Fabric : </span><a href="http://dev.mysql.com/doc/mysql-utilities/1.6/en/fabric.html" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank"><span style="color:rgb(0,0,255);">http://dev.mysql.com/doc/mysql-utilities/1.6/en/fabric.html</span></a></p><p><span style="color: rgb(51, 51, 51);">MySQL Cluster: </span><a href="http://dev.mysql.com/tech-resources/articles/mysql-cluster-7.3.html" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank"><span style="color:rgb(0,0,255);">http://dev.mysql.com/tech-resources/articles/mysql-cluster-7.3.html</span></a></p><div><br/></div><div><span style="color: rgb(51, 51, 51);">Percona XtraDB Cluster:  </span><a href="http://www.percona.com/" style="color:rgb(51, 102, 153);text-decoration:none;" target="_blank"><span style="color:rgb(0,0,255);">http://www.percona.com</span></a></div></div><div style="zoom:1;float:right;"><div><span style="font-size: 12px;"><span style="font-family: Arial, Console, Verdana, 'Courier New';"><span style="color: rgb(51, 51, 51);"><span style="visibility:hidden;display:block;height:0px;clear:both;">.</span></span></span></span></div></div><div><ul style="display: block; font-style: normal; font-variant: normal; font-weight: normal; clear: both; float: left; margin: 30px 0px 5px; padding: 10px 0px 0px;"><li><span style="color:rgb(102, 102, 102);font-style:normal;font-variant:normal;font-weight:normal;font-size:14px;font-family:&quot;Microsoft YaHei&quot;, Arial, Helvetica, sans-serif;display:block;height:0px;clear:both;visibility:hidden;">.</span></li></ul></div></div></div></div></div></div></div></span>
</div></body></html> 