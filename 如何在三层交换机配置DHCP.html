<html>
<head>
  <title>如何在三层交换机配置DHCP</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1790"/>
<h1>如何在三层交换机配置DHCP</h1>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="font-size: 16px"><div style="font-family:宋体, 'Arial Narrow', arial, serif;font-size:12px;color:rgb(85, 85, 85);background:rgb(228, 228, 228);"><div style="overflow:hidden;"><div style="padding:0px;margin:0px;background:rgb(255, 255, 255);margin-top:5px;"><div style="padding:0px;margin:0px;clear:both;"><div style="padding:0px;margin:0 0 10px;border-top-width:2px;border-top-style:solid;border-top-color:rgb(239, 239, 239);clear:both;position:relative;"><div style="padding:0px;margin:20px 15px 8px;line-height:2;font-size:14px;border-bottom-width:1px;border-bottom-style:dashed;border-bottom-color:rgb(217, 217, 217);word-wrap:break-word;word-break:normal;"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">通过本实验掌握，如何在Cisco Catalyst 3550交换机来配置DHCP服务，实现对内网主机分配IP地址，网关，DNS，WINS，租期，域名等。可能你之前是在windows Server服务器或者Cisco Router 部署过DHCP,但在工程项目中，根据需求，大多是在接入层或者汇聚层多层交换机来配置的，可以同时实现DHCP Snooping等技术。<br style="padding:0px;margin:0px;"/></b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;"><br style="padding:0px;margin:0px;"/></b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><strong style="padding:0px;margin:0px;">实验拓扑：</strong></font></div><div style="padding:0px;margin:0px;"><a href="http://img1.51cto.com/attachment/200910/23/383839_1256266205IsNm.png" style="padding:0px;margin:0px;color:rgb(56, 109, 0);text-decoration:none;" target="\&quot;_blank\&quot;"><font size="4" style="padding:0px;margin:0px;"><img src="如何在三层交换机配置DHCP_files/383839_1256266206fdv0.png" type="image/png" data-filename="383839_1256266206fdv0.png" alt="image" border="0" height="250" style="padding:0px;margin:0px;vertical-align:top;border:none;border-top-width:0px;border-bottom-width:0px;border-left-width:0px;cursor: default;" title="image" width="500"/></font></a></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"> </font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"> </font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">实验过程：</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第一步：</b><b style="padding:0px;margin:0px;">Catalyst 3550</b><b style="padding:0px;margin:0px;">底层配置</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch(config)#<b style="padding:0px;margin:0px;">no ip do lo</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch(config)<b style="padding:0px;margin:0px;">#line con 0</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch(config-line)#<b style="padding:0px;margin:0px;">no exec-t</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch(config-line)#<b style="padding:0px;margin:0px;">logg syn</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch(config-line)#<b style="padding:0px;margin:0px;">host Switch_Dhcp</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">int f0/1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">no sh</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">spanning-tree portfast</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">连接终端的接口下，开启</b><b style="padding:0px;margin:0px;">portfast</b><b style="padding:0px;margin:0px;">特性，跳过生成树的选举，接口立即进入转发状态</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">%Warning: portfast should only be enabled on ports connected to a single</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">host. Connecting hubs, concentrators, switches, bridges, etc... to this</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">interface when portfast is enabled, can cause temporary bridging loops.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">Use with CAUTION</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">%Portfast has been configured on FastEthernet0/1 but will only</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">have effect when the interface is in a non-trunking mode.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">end</b></font></div></td></tr></tbody></table></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第二步</b><b style="padding:0px;margin:0px;">:</b> <b style="padding:0px;margin:0px;">开启</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">服务，定义分配地址池范围及掩码，网关，</b><b style="padding:0px;margin:0px;">DNS</b><b style="padding:0px;margin:0px;">，域名，租期等</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">//<b style="padding:0px;margin:0px;">全局下开启</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">服务，该服务默认是关闭的</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">service dhcp</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">关闭</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">分配冲突，日志记录消息</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">no ip dhcp conflict logging</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">创建</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">地址池，名称为可以是任意字符</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">ip dhcp pool cisco</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定要通过</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">分配的网段和掩码，还有另外一种写法（</b><b style="padding:0px;margin:0px;">192.168.0.0 255.255.255.0</b><b style="padding:0px;margin:0px;">）</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">network 192.168.0.0 /24</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定分配的网关地址</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">default-router 192.168.0.1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">域名，域名可以为任意字符</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">domain-name</b> <a href="http://www.cisco.com.cn/" style="padding:0px;margin:0px;color:rgb(56, 109, 0);text-decoration:none;" target="\&quot;_blank\&quot;"><b style="padding:0px;margin:0px;">www.cisco.com.cn</b></a></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">通过</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">分配到</b><b style="padding:0px;margin:0px;">DNS</b><b style="padding:0px;margin:0px;">地址，（这里指定的是当地电信部门的真实地址，全国各地市不一样的）</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">dns 218.30.19.40 61.134.1.4</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//netbios</b><b style="padding:0px;margin:0px;">服务器地址，可选的配置</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">netbios-name-server 192.168.0.10</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定通过</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">分配到地址，租期为永久</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)<b style="padding:0px;margin:0px;">#lease infinite</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(dhcp-config)#<b style="padding:0px;margin:0px;">end</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">指定不通过</b><b style="padding:0px;margin:0px;">DHCP</b> <b style="padding:0px;margin:0px;">地址池中分配的地址，也就是排除的地址。如果这些地址被分配给</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">使用，就有可能造成网络中</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址冲突。如：</b><b style="padding:0px;margin:0px;">192.168.0.1</b> <b style="padding:0px;margin:0px;">是网关地址，该地址只能是分配所有</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">做网关地址，不能做</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址使用。所以要排除。</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">ip dhcp excluded-address 192.168.0.1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)# <b style="padding:0px;margin:0px;">ip dhcp excluded-address 192.168.0.10</b></font></div></td></tr></tbody></table></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第三步：查看</b><b style="padding:0px;margin:0px;">VLAN</b><b style="padding:0px;margin:0px;">信息，并启用</b><b style="padding:0px;margin:0px;">SVI</b><b style="padding:0px;margin:0px;">接口</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#<b style="padding:0px;margin:0px;">show vlan brief</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">VLAN Name Status Ports</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">---- -------------------------------- --------- -------------------------------</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">1 default active Fa0/1, Fa0/2, Fa0/3, Fa0/4</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Fa0/5, Fa0/6, Fa0/7, Fa0/8</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Fa0/9, Fa0/10, Fa0/11, Fa0/12</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Fa0/13, Fa0/15, Fa0/16, Fa0/17</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Fa0/18, Fa0/19, Fa0/20, Fa0/21</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Fa0/22, Fa0/23, Fa0/24, Gi0/1</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Gi0/2</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">1002 fddi-default act/unsup</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">1003 token-ring-default act/unsup</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">1004 fddinet-default act/unsup</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">1005 trnet-default act/unsup</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#conf t</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Enter configuration commands, one per line. End with CNTL/Z.</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">进入管理</b><b style="padding:0px;margin:0px;">VLAN1</b> <b style="padding:0px;margin:0px;">下，启用</b><b style="padding:0px;margin:0px;">SVI</b><b style="padding:0px;margin:0px;">功能</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config)#<b style="padding:0px;margin:0px;">int vlan 1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">配置</b><b style="padding:0px;margin:0px;">VLAN</b><b style="padding:0px;margin:0px;">的地址为</b><b style="padding:0px;margin:0px;">192.168.0.1</b> <b style="padding:0px;margin:0px;">掩码为</b><b style="padding:0px;margin:0px;">24</b><b style="padding:0px;margin:0px;">位，默认情况下</b><b style="padding:0px;margin:0px;">Cisco Catalyst</b><b style="padding:0px;margin:0px;">交换机所有的物理接口都属于</b><b style="padding:0px;margin:0px;">VLAN1</b><b style="padding:0px;margin:0px;">，此地址也就是</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">网关地址。</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">ip add 192.168.0.1 255.255.255.0</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">no sh</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp(config-if)#<b style="padding:0px;margin:0px;">end</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">00:09:07: %SYS-5-CONFIG_I: Configured from console by console</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">00:09:08: %LINK-3-UPDOWN: Interface Vlan1, changed state to up</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">00:09:09: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to</font></div></td></tr></tbody></table></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第四步：查看当前交换机配置文件</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">验证</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">的配置信息</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#<b style="padding:0px;margin:0px;">sh run | begin ip dhcp</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">no ip dhcp conflict logging</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">ip dhcp excluded-address 192.168.0.1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">ip dhcp excluded-address 192.168.0.10</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">!</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">ip dhcp pool cisco</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">network 192.168.0.0 255.255.255.0</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">default-router 192.168.0.1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">domain-name www.cisco.com.cn</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">dns-server 218.30.19.40 61.134.1.4</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">netbios-name-server 192.168.0.10</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">lease infinite</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">interface Vlan1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">ip address 192.168.0.1 255.255.255.0</b></font></div></td></tr></tbody></table></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第五步：此时将</b><b style="padding:0px;margin:0px;">PC1</b><b style="padding:0px;margin:0px;">的网线插入</b><b style="padding:0px;margin:0px;">Catalyst 3550</b> <b style="padding:0px;margin:0px;">的</b><b style="padding:0px;margin:0px;">F0/1</b><b style="padding:0px;margin:0px;">接口，并在</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">上查看</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址获得信息。</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">上的本地连接，</b><b style="padding:0px;margin:0px;">TCP/IP</b> <b style="padding:0px;margin:0px;">设置为自动获得</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址形式。</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">上查看方法：开始</b><b style="padding:0px;margin:0px;">-</b><b style="padding:0px;margin:0px;">运行</b><b style="padding:0px;margin:0px;">-cmd-ipconfig/all</b></font></div><div style="padding:0px;margin:0px;"><a href="http://img1.51cto.com/attachment/200910/23/383839_1256266207H7zg.png" style="padding:0px;margin:0px;color:rgb(56, 109, 0);text-decoration:none;" target="\&quot;_blank\&quot;"><font size="4" style="padding:0px;margin:0px;"><img src="如何在三层交换机配置DHCP_files/383839_12562662107gIb.png" type="image/png" data-filename="383839_12562662107gIb.png" alt="image" border="0" height="424" style="padding:0px;margin:0px;vertical-align:top;border:none;border-top-width:0px;border-bottom-width:0px;border-left-width:0px;cursor: default;" title="image" width="644"/></font></a></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">从以上信息可以得出，</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">已经能从</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">服务器获得</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址等信息，实验现象成功。</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第六步：查看交换机</b><b style="padding:0px;margin:0px;">DHCP</b> <b style="padding:0px;margin:0px;">动态绑定，以及交换机</b><b style="padding:0px;margin:0px;">DHCP Server</b><b style="padding:0px;margin:0px;">状态信息</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">/<b style="padding:0px;margin:0px;">/</b><b style="padding:0px;margin:0px;">查看</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">动态绑定信息，从这里可以看到</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">，从</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">地址池中的得到</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址，以及</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">的</b><b style="padding:0px;margin:0px;">MAC</b><b style="padding:0px;margin:0px;">地址等</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#<b style="padding:0px;margin:0px;">show ip dhcp binding</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">IP address Client-ID/ Lease expiration Type</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Hardware address</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">192.168.0.2 0100.16d3.249f.fd Infinite Automatic</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">//</b><b style="padding:0px;margin:0px;">查看</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">服务器工作状态</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#<b style="padding:0px;margin:0px;">show ip dhcp server statistics</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Memory usage 5661</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Address pools <b style="padding:0px;margin:0px;">1</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Database agents 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Automatic bindings 1</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Manual bindings 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Expired bindings 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Malformed messages 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Message Received</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">BOOTREQUEST 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPDISCOVER <b style="padding:0px;margin:0px;">2</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPREQUEST <b style="padding:0px;margin:0px;">3</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">DHCPDECLINE 0</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPRELEASE 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPINFORM 3</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Message Sent</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">BOOTREPLY 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPOFFER 2</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPACK 6</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">DHCPNAK 0</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#clear ip dhcp binding *</font></div></td></tr></tbody></table></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">第七步：使用</b><b style="padding:0px;margin:0px;">debug</b> <b style="padding:0px;margin:0px;">调试命令查看</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">申请</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址过程（</b><b style="padding:0px;margin:0px;">DHCP</b><b style="padding:0px;margin:0px;">工作过程）</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">在</b><b style="padding:0px;margin:0px;">PC</b><b style="padding:0px;margin:0px;">上：开始</b><b style="padding:0px;margin:0px;">-</b><b style="padding:0px;margin:0px;">运行</b><b style="padding:0px;margin:0px;">-cmd-ipconfig /release (</b><b style="padding:0px;margin:0px;">释放获得</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址</b><b style="padding:0px;margin:0px;">)</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">重新申请</b><b style="padding:0px;margin:0px;">IP</b><b style="padding:0px;margin:0px;">地址</b><b style="padding:0px;margin:0px;">ipconfig /renew</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">此时查看交换机日志信息</b></font><table border="1" cellpadding="0" cellspacing="0" style="font-weight:inherit;font-style:inherit;font-variant:inherit;padding:0px;font-size:12px;margin:0px auto;margin-bottom:10px;border-collapse:collapse;display:table;"><tbody style="padding:0px;margin:0px;"><tr style="padding:0px;margin:0px;font-size:12px;"><td style="margin:0px;font-size:12px;padding:5px 10px;border:1px solid rgb(221, 221, 221);background:white;" valign="top"><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#<b style="padding:0px;margin:0px;">debug ip dhcp server events</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">01:13:12: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/1, changed state to up</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:13: DHCPD: DHCPDISCOVER received from client 0100.16d3.249f.fd on interface Vlan1.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;">Switch_Dhcp#</font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: assigned IP address 192.168.0.3 to client 0100.16d3.249f.fd.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: Sending DHCPOFFER to client 0100.16d3.249f.fd (192.168.0.3).</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: broadcasting BOOTREPLY to client 0016.d324.9ffd.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: DHCPREQUEST received from client 0100.16d3.249f.fd.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: Sending DHCPACK to client 0100.16d3.249f.fd (192.168.0.3).</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:20: DHCPD: broadcasting BOOTREPLY to client 0016.d324.9ffd.</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">Switch_Dhcp#</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:23: DHCPD: DHCPINFORM received from client 0100.16d3.249f.fd (192.168.0.3).</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:23: DHCPD: Sending DHCPACK to client 0100.16d3.249f.fd (192.168.0.3).</b></font></div><div style="padding:0px;margin:0px;"><font size="4" style="padding:0px;margin:0px;"><b style="padding:0px;margin:0px;">01:13:23: DHCPD: unicasting BOOTREPLY to client 0016.d324.9ffd (192.168.0.3).</b></font></div></td></tr></tbody></table></div></div></div></div></div></div></div></div></span>
</div></body></html> 