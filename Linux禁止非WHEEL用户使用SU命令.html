<html>
<head>
  <title>Linux禁止非WHEEL用户使用SU命令</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1853"/>
<h1>Linux禁止非WHEEL用户使用SU命令</h1>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="margin: 5px 0px; font-size: 20px; line-height: 30px; font-family: 'Microsoft YaHei'; text-align: left; widows: 1; background-color: rgb(255, 255, 255);"> 
<h1 style="margin: 0px; padding: 0px; display: inline; font-weight: normal; font-size: 20px; vertical-align: middle;"><a href="http://blog.csdn.net/wuweilong/article/details/39722875" style="color: rgb(51, 51, 51); text-decoration: none;">Linux禁止非WHEEL用户使用SU命令</a></h1></div><div style="padding: 5px 0px; color: rgb(153, 153, 153); font-size: 12px; line-height: 24px; font-family: Arial; text-align: right; widows: 1; background-color: rgb(255, 255, 255);"><span style="margin: 0px 5px; float: left;">分类： <a href="http://blog.csdn.net/wuweilong/article/category/933011" style="color: rgb(255, 153, 0); text-decoration: none;">技术博文</a> <a href="http://blog.csdn.net/wuweilong/article/category/1126008" style="color: rgb(255, 153, 0); text-decoration: none;">Linxu技术博文</a></span><span style="margin: 0px 5px 0px 0px;">2014-10-01 22:47</span> <span style="margin: 0px 5px; padding: 0px 0px 0px 14px; background: url(http://static.blog.csdn.net/images/ico_view.png) 0% 50% no-repeat;" title="阅读次数">1200人阅读</span> <span style="margin: 0px 5px; padding: 0px 0px 0px 14px; background: url(http://static.blog.csdn.net/images/ico_comm.png) 0% 50% no-repeat;" title="评论次数"><a href="http://blog.csdn.net/wuweilong/article/details/39722875#comments" style="color: rgb(255, 153, 0); text-decoration: none;">评论</a>(0)</span> <span style="margin: 0px 5px;"><a style="color: rgb(255, 153, 0);" title="收藏">收藏</a></span> <span style="margin: 0px 5px;"><a href="http://blog.csdn.net/wuweilong/article/details/39722875#report" style="color: rgb(255, 153, 0); text-decoration: none;" title="举报">举报</a></span></div><div style="margin: 20px 0px 0px; font-size: 14px; line-height: 26px; font-family: Arial; text-align: left; widows: 1; background-color: rgb(255, 255, 255);"><p style="margin: 0px; padding: 0px;">        通常情况下，一般用户通过执行“su -”命令、输入正确的root密码，可以登录为root用户来对系统进行管理员级别的配置。</p><p style="margin: 0px; padding: 0px;">       但是，为了更进一步加强系统的安全性，有必要建立一个管理员的 组，只允许这个组的用户来执行“su -”命令登录为root用户，而让其他组的用户即使执行“su -”、输入了正确的root密码，也无法登录为root用户。在UNIX和Linux下，这个组的名称通常为“wheel”。</p><p style="margin: 0px; padding: 0px;">一、禁止非whell组用户切换到root<br/>
1、 修改/etc/pam.d/su配置</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image.png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# vi /etc/pam.d/su ← 打开这个配置文件  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">#auth required /lib/security/$ISA/pam_wheel.so use_uid      ← 找到此行，去掉行首的“#”  </span></li></ol></div><p style="margin: 0px; padding: 0px;"><br/>
2、 修改/etc/login.defs文件</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [1].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# echo “SU_WHEEL_ONLY yes” &gt;&gt; /etc/login.defs　← 添加语句到行末以上操作完成后，可以再建立一个新用户，然后用这个新建的用户测试会发现，没有加入到wheel组的用户，执行“su -”命令，即使输入了正确的root密码，也无法登录为root用户  </span></span></li></ol></div><p style="margin: 0px; padding: 0px;"><br/>
 </p><p style="margin: 0px; padding: 0px;">3、 添加一个用户woo，测试是否可以切换到root</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [2].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# useradd woo  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]# passwd woo  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Changing password for user woo.  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">New UNIX password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">BAD PASSWORD: it is WAY too short  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Retype new UNIX password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">passwd: all authentication tokens updated successfull  </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">4、通过woo用户登录尝试切换到root   </p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [3].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[woo@db01 ~]$ su - root           ← 即使密码输入正确也无法切换  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">su: incorrect password  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[woo@db01 ~]$   </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">5: 把root用户加入wheel组再尝试切换,可以切换</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [4].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# usermod -G wheel woo    ← 将普通用户woo加在管理员组wheel组中  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]# su - woo  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[woo@db01 ~]$ su - root           ←  这时候我们看到是可以切换了     </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]#       </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">二、添加用户到管理员，禁止普通用户su到root<br/>
6、添加用户，并加入管理员组，禁止普通用户su到root，以配合之后安装OpenSSH/OpenSSL提升远程管理安全</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [5].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# useradd admin  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]# passwd admin  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Changing password for user admin.  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">New UNIX password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">BAD PASSWORD: it is too short  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Retype new UNIX password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">passwd: all authentication tokens updated successfully.  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]# usermod -G wheel admin   (usermod -G wheel admin 或 usermod -G10 admin（10是wheel组的ID号））  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]# su - admin  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[admin@db01 ~]$ su - root  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">Password:   </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">[root@db01 ~]#   </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">方法一：wheel组也可指定为其它组，编辑/etc/pam.d/su添加如下两行</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [6].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# vi /etc/pam.d/su  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">auth sufficient /lib/security/pam_rootok.so debug  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">auth required /lib/security/pam_wheel.so group=wheel   </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">方法二：编辑/etc/pam.d/su将如下行#符号去掉</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [7].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# vi /etc/pam.d/su  </span></span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-style: none none none solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: rgb(85, 85, 85); line-height: 18px; background-color: rgb(248, 248, 248);"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">#RedHat#auth required /lib/security/$ISA/pam_wheel.so use_uid 　 ← 找到此行，去掉行首的“#”  </span></li><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;">#CentOS5#auth required pam_wheel.so use_uid 　 ← 找到此行，去掉行首的“#”  </span></li></ol></div><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">#保存退出即可============</p><div style="font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 936.53125px; overflow: auto; padding-top: 1px; margin: 18px 0px !important; background-color: rgb(231, 229, 220);"><div style="padding-left: 45px;"><div style="padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(153, 153, 153); background-color: rgb(248, 248, 248);"><b>[plain]</b> <a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="view plain">view plain</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="copy">copy</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="print">print</a><a href="http://blog.csdn.net/wuweilong/article/details/39722875#" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" title="?">?</a><a href="https://code.csdn.net/snippets/478516" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="在CODE上查看代码片"><img src="Linux禁止非WHEEL用户使用SU命令_files/Image [8].png" type="image/png" data-filename="Image.png" alt="在CODE上查看代码片" height="12" style="cursor: default;" width="12"/></a><a href="https://code.csdn.net/snippets/478516/fork" style="color: rgb(160, 160, 160); text-decoration: none; border: none; padding: 0px; margin: 0px 10px 0px 0px; background-image: none; background-color: inherit;" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="cursor: default;" width="12"></img></a></div></div><ol start="1" style="margin: 0px 0px 1px 45px !important; padding: 0px; border: none; list-style-position: initial; list-style-image: initial; color: rgb(92, 92, 92); background-color: rgb(255, 255, 255);"><li style="margin: 0px !important; padding: 0px 3px 0px 10px !important; border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: solid; border-left-width: 3px; border-left-color: rgb(153, 153, 153); list-style: decimal-leading-zero outside; color: inherit; line-height: 18px;"><span style="margin: 0px; padding: 0px; border: none; color: black; background-color: inherit;"><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">[root@db01 ~]# echo &quot;SU_WHEEL_ONLY yes&quot; &gt;&gt; /etc/login.defs　← 添加语句到行末  </span></span></li></ol></div><p style="margin: 0px; padding: 0px;"><br/>
 </p><p style="margin: 0px; padding: 0px;"> </p><p style="margin: 0px; padding: 0px;">（实际测试这步操作可省略）</p></div></span>
</div></body></html> 