<html>
<head>
  <title>Python使用SMTP发送邮件 | 菜鸟教程</title>
  <basefont face="宋体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 宋体;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1744"/>
<h1>Python使用SMTP发送邮件 | 菜鸟教程</h1>

<div><span><br/><div style="font-size: 16px"><div style="overflow-y:scroll;"><div style="font-size:12px;color:rgb(0, 0, 0);background-color:rgb(246, 244, 240);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;"><div><div style="background-color:rgb(255, 255, 255);"><div style="overflow:hidden;background-color:rgb(255, 255, 255);"><div> <h1 style="font-size:210%;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;margin-top:0px;font-weight:bold;color:rgb(0, 0, 0);background-color:transparent;">Python使用SMTP发送邮件</h1> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。</p> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">python的smtplib提供了一种很方便的途径发送电子邮件。它对smtp协议进行了简单的封装。</p> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">Python创建 SMTP 对象语法如下：</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib

smtpObj </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 0, 0);">host </span><span style="color:rgb(102, 102, 0);">[,</span><span style="color:rgb(0, 0, 0);"> port </span><span style="color:rgb(102, 102, 0);">[,</span><span style="color:rgb(0, 0, 0);"> local_hostname</span><span style="color:rgb(102, 102, 0);">]]]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">)</span></pre> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">参数说明：</p> <ul style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;"> <li style="padding:2px 0px;"> host: SMTP 服务器主机。 你可以指定主机的ip地址或者域名如:w3cschool.cc，这个是可选参数。 </li><li style="padding:2px 0px;"> port: 如果你提供了 host 参数, 你需要指定 SMTP 服务使用的端口号，一般情况下SMTP端口号为25。 </li><li style="padding:2px 0px;"> local_hostname: 如果SMTP在你的本机上，你只需要指定服务器地址为 localhost 即可。 </li></ul> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">Python SMTP对象使用sendmail方法发送邮件，语法如下：</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">from_addr</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> to_addrs</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> msg</span><span style="color:rgb(102, 102, 0);">[,</span><span style="color:rgb(0, 0, 0);"> mail_options</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> rcpt_options</span><span style="color:rgb(102, 102, 0);">]</span></pre> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">参数说明：</p> <ul style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;"> <li style="padding:2px 0px;"> from_addr: 邮件发送者地址。 </li><li style="padding:2px 0px;"> to_addrs: 字符串列表，邮件发送地址。 </li><li style="padding:2px 0px;"> msg: 发送消息 </li></ul> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">这里要注意一下第三个参数，msg是字符串，表示邮件。我们知道邮件一般由标题，发信人，收件人，邮件内容，附件等构成，发送邮件的时候，要注意msg的格式。这个格式就是smtp协议中定义的格式。</p> <h3 style="font-size:120%;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:bold;color:rgb(0, 0, 0);background-color:transparent;">实例</h3> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">以下是一个使用Python发送邮件简单的实例：</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(136, 0, 0);">#!/usr/bin/python</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib

sender </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'from@fromdomain.com'</span><span style="color:rgb(0, 0, 0);">
receivers </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'to@todomain.com'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);">

message </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;From: From Person &lt;from@fromdomain.com&gt;
To: To Person &lt;to@todomain.com&gt;
Subject: SMTP e-mail test

This is a test e-mail message.
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(0, 0, 136);">try</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   smtpObj </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'localhost'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
   smtpObj</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">sender</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> receivers</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> message</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">         
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Successfully sent email&quot;</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">except</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">SMTPException</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Error: unable to send email&quot;</span></pre> <hr style="color:rgb(212, 212, 212);height:1px;border:0px;clear:both;background-color:rgb(212, 212, 212);"/> <h2 style="font-size:180%;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;margin-top:10px;margin-bottom:10px;font-weight:bold;color:rgb(0, 0, 0);background-color:transparent;">使用Python发送HTML格式的邮件</h2> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">Python发送HTML格式的邮件与发送纯文本消息的邮件不同之处就是将MIMEText中_subtype设置为html。具体代码如下：</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib  
</span><span style="color:rgb(0, 0, 136);">from</span><span style="color:rgb(0, 0, 0);"> email</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">mime</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">text </span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEText</span><span style="color:rgb(0, 0, 0);">  
mailto_list</span><span style="color:rgb(102, 102, 0);">=[</span><span style="color:rgb(0, 136, 0);">&quot;YYY@YYY.com&quot;</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> 
mail_host</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;smtp.XXX.com&quot;</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#设置服务器</span><span style="color:rgb(0, 0, 0);">
mail_user</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;XXX&quot;</span><span style="color:rgb(0, 0, 0);">    </span><span style="color:rgb(136, 0, 0);">#用户名</span><span style="color:rgb(0, 0, 0);">
mail_pass</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;XXXX&quot;</span><span style="color:rgb(0, 0, 0);">   </span><span style="color:rgb(136, 0, 0);">#口令 </span><span style="color:rgb(0, 0, 0);">
mail_postfix</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;XXX.com&quot;</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#发件箱的后缀</span><span style="color:rgb(0, 0, 0);">
  
</span><span style="color:rgb(0, 0, 136);">def</span><span style="color:rgb(0, 0, 0);"> send_mail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">to_list</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 136);">sub</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);">content</span><span style="color:rgb(102, 102, 0);">):</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#to_list：收件人；sub：主题；content：邮件内容</span><span style="color:rgb(0, 0, 0);">
    me</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;hello&quot;</span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 136, 0);">&quot;&lt;&quot;</span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 0, 0);">mail_user</span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 136, 0);">&quot;@&quot;</span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 0, 0);">mail_postfix</span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 136, 0);">&quot;&gt;&quot;</span><span style="color:rgb(0, 0, 0);">   </span><span style="color:rgb(136, 0, 0);">#这里的hello可以任意设置，收到信后，将按照设置显示</span><span style="color:rgb(0, 0, 0);">
    msg </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEText</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">content</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);">_subtype</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">'html'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);">_charset</span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">'gb2312'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">    </span><span style="color:rgb(136, 0, 0);">#创建一个实例，这里设置为html格式邮件</span><span style="color:rgb(0, 0, 0);">
    msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'Subject'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 0, 136);">sub</span><span style="color:rgb(0, 0, 0);">    </span><span style="color:rgb(136, 0, 0);">#设置主题</span><span style="color:rgb(0, 0, 0);">
    msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'From'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> me  
    msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'To'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;;&quot;</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">join</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">to_list</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">  
    </span><span style="color:rgb(0, 0, 136);">try</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">  
        s </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">  
        s</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">connect</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">mail_host</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#连接smtp服务器</span><span style="color:rgb(0, 0, 0);">
        s</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">login</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">mail_user</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);">mail_pass</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#登陆服务器</span><span style="color:rgb(0, 0, 0);">
        s</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">me</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> to_list</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> msg</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">as_string</span><span style="color:rgb(102, 102, 0);">())</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);">#发送邮件</span><span style="color:rgb(0, 0, 0);">
        s</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">close</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">  
        </span><span style="color:rgb(0, 0, 136);">return</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 0, 136);">True</span><span style="color:rgb(0, 0, 0);">  
    </span><span style="color:rgb(0, 0, 136);">except</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">Exception</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> e</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">  
        </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> str</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">e</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">  
        </span><span style="color:rgb(0, 0, 136);">return</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 0, 136);">False</span><span style="color:rgb(0, 0, 0);">  
</span><span style="color:rgb(0, 0, 136);">if</span><span style="color:rgb(0, 0, 0);"> __name__ </span><span style="color:rgb(102, 102, 0);">==</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'__main__'</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">  
    </span><span style="color:rgb(0, 0, 136);">if</span><span style="color:rgb(0, 0, 0);"> send_mail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">mailto_list</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 136, 0);">&quot;hello&quot;</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 136, 0);">&quot;&lt;a href='http://www.cnblogs.com/xiaowuyi'&gt;小五义&lt;/a&gt;&quot;</span><span style="color:rgb(102, 102, 0);">):</span><span style="color:rgb(0, 0, 0);">  
        </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;发送成功&quot;</span><span style="color:rgb(0, 0, 0);">  
    </span><span style="color:rgb(0, 0, 136);">else</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">  
        </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;发送失败&quot;</span><span style="color:rgb(0, 0, 0);">  </span></pre> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">或者你也可以在消息体中指定Content-type为text/html,如下实例:</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(136, 0, 0);">#!/usr/bin/python</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib

message </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;From: From Person &lt;from@fromdomain.com&gt;
To: To Person &lt;to@todomain.com&gt;
MIME-Version: 1.0
Content-type: text/html
Subject: SMTP HTML e-mail test

This is an e-mail message to be sent in HTML format

&lt;b&gt;This is HTML message.&lt;/b&gt;
&lt;h1&gt;This is headline.&lt;/h1&gt;
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(0, 0, 136);">try</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   smtpObj </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'localhost'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
   smtpObj</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">sender</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> receivers</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> message</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">         
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Successfully sent email&quot;</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">except</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">SMTPException</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Error: unable to send email&quot;</span></pre> <hr style="color:rgb(212, 212, 212);height:1px;border:0px;clear:both;background-color:rgb(212, 212, 212);"/> <h2 style="font-size:180%;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;margin-top:10px;margin-bottom:10px;font-weight:bold;color:rgb(0, 0, 0);background-color:transparent;">Python发送带附件的邮件</h2> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">发送带附件的邮件，首先要创建MIMEMultipart()实例，然后构造附件，如果有多个附件，可依次构造，最后利用smtplib.smtp发送。</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(0, 0, 136);">from</span><span style="color:rgb(0, 0, 0);"> email</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">mime</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">text </span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEText</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">from</span><span style="color:rgb(0, 0, 0);"> email</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">mime</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">multipart </span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEMultipart</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib

</span><span style="color:rgb(136, 0, 0);">#创建一个带附件的实例</span><span style="color:rgb(0, 0, 0);">
msg </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEMultipart</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);">#构造附件1</span><span style="color:rgb(0, 0, 0);">
att1 </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEText</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">open</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'d:\\123.rar'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'rb'</span><span style="color:rgb(102, 102, 0);">).</span><span style="color:rgb(0, 0, 0);">read</span><span style="color:rgb(102, 102, 0);">(),</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'base64'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'gb2312'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
att1</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">&quot;Content-Type&quot;</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'application/octet-stream'</span><span style="color:rgb(0, 0, 0);">
att1</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">&quot;Content-Disposition&quot;</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'attachment; filename=&quot;123.doc&quot;'</span><span style="color:rgb(136, 0, 0);">#这里的filename可以任意写，写什么名字，邮件中显示什么名字</span><span style="color:rgb(0, 0, 0);">
msg</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">attach</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">att1</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);">#构造附件2</span><span style="color:rgb(0, 0, 0);">
att2 </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">MIMEText</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">open</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'d:\\123.txt'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'rb'</span><span style="color:rgb(102, 102, 0);">).</span><span style="color:rgb(0, 0, 0);">read</span><span style="color:rgb(102, 102, 0);">(),</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'base64'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'gb2312'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
att2</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">&quot;Content-Type&quot;</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'application/octet-stream'</span><span style="color:rgb(0, 0, 0);">
att2</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">&quot;Content-Disposition&quot;</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'attachment; filename=&quot;123.txt&quot;'</span><span style="color:rgb(0, 0, 0);">
msg</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">attach</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">att2</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);">#加邮件头</span><span style="color:rgb(0, 0, 0);">
msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'to'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'YYY@YYY.com'</span><span style="color:rgb(0, 0, 0);">
msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'from'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'XXX@XXX.com'</span><span style="color:rgb(0, 0, 0);">
msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'subject'</span><span style="color:rgb(102, 102, 0);">]</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'hello world'</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(136, 0, 0);">#发送邮件</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">try</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
    server </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">
    server</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">connect</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'smtp.XXX.com'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
    server</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">login</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'XXX'</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 136, 0);">'XXXXX'</span><span style="color:rgb(102, 102, 0);">)#</span><span style="color:rgb(0, 0, 0);">XXX</span><span style="color:rgb(102, 102, 0);">为用户名，</span><span style="color:rgb(0, 0, 0);">XXXXX</span><span style="color:rgb(102, 102, 0);">为密码</span><span style="color:rgb(0, 0, 0);">
    server</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'from'</span><span style="color:rgb(102, 102, 0);">],</span><span style="color:rgb(0, 0, 0);"> msg</span><span style="color:rgb(102, 102, 0);">[</span><span style="color:rgb(0, 136, 0);">'to'</span><span style="color:rgb(102, 102, 0);">],</span><span style="color:rgb(0, 0, 0);">msg</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">as_string</span><span style="color:rgb(102, 102, 0);">())</span><span style="color:rgb(0, 0, 0);">
    server</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">quit</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">
    </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'发送成功'</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">except</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">Exception</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> e</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">  
    </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> str</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">e</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);"> </span></pre> <p style="line-height:140%;font-size:12px;font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;">以下实例指定了Content-type header 为 multipart/mixed，并发送/tmp/test.txt 文本文件：</p> <pre style="font-family:'courier new';margin:15px auto;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:12px;line-height:20px;font-style:normal;word-break:break-all;word-wrap:break-word;border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221, 221, 221);background:url(http://www.runoob.com/images/codecolorer_bg.gif) 50% 0% rgb(251, 251, 251);padding:10px 15px;"><span style="color:rgb(136, 0, 0);">#!/usr/bin/python</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> smtplib
</span><span style="color:rgb(0, 0, 136);">import</span><span style="color:rgb(0, 0, 0);"> base64

filename </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;/tmp/test.txt&quot;</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);"># 读取文件内容并使用 base64 编码</span><span style="color:rgb(0, 0, 0);">
fo </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> open</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">filename</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;rb&quot;</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
filecontent </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> fo</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">read</span><span style="color:rgb(102, 102, 0);">()</span><span style="color:rgb(0, 0, 0);">
encodedcontent </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> base64</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">b64encode</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">filecontent</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">  </span><span style="color:rgb(136, 0, 0);"># base64</span><span style="color:rgb(0, 0, 0);">

sender </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'webmaster@tutorialpoint.com'</span><span style="color:rgb(0, 0, 0);">
reciever </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">'amrood.admin@gmail.com'</span><span style="color:rgb(0, 0, 0);">

marker </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;AUNIQUEMARKER&quot;</span><span style="color:rgb(0, 0, 0);">

body </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;
This is a test email to send an attachement.
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(136, 0, 0);"># 定义头部信息</span><span style="color:rgb(0, 0, 0);">
part1 </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;From: From Person &lt;me@fromdomain.net&gt;
To: To Person &lt;amrood.admin@gmail.com&gt;
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=%s
--%s
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">%</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">marker</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> marker</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);"># 定义消息动作</span><span style="color:rgb(0, 0, 0);">
part2 </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;Content-Type: text/plain
Content-Transfer-Encoding:8bit

%s
--%s
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">%</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">body</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);">marker</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">

</span><span style="color:rgb(136, 0, 0);"># 定义附近部分</span><span style="color:rgb(0, 0, 0);">
part3 </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;&quot;&quot;Content-Type: multipart/mixed; name=\&quot;%s\&quot;
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename=%s

%s
--%s--
&quot;&quot;&quot;</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 102, 0);">%(</span><span style="color:rgb(0, 0, 0);">filename</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> filename</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> encodedcontent</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> marker</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
message </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> part1 </span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 0, 0);"> part2 </span><span style="color:rgb(102, 102, 0);">+</span><span style="color:rgb(0, 0, 0);"> part3

</span><span style="color:rgb(0, 0, 136);">try</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   smtpObj </span><span style="color:rgb(102, 102, 0);">=</span><span style="color:rgb(0, 0, 0);"> smtplib</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">SMTP</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 136, 0);">'localhost'</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
   smtpObj</span><span style="color:rgb(102, 102, 0);">.</span><span style="color:rgb(0, 0, 0);">sendmail</span><span style="color:rgb(102, 102, 0);">(</span><span style="color:rgb(0, 0, 0);">sender</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> reciever</span><span style="color:rgb(102, 102, 0);">,</span><span style="color:rgb(0, 0, 0);"> message</span><span style="color:rgb(102, 102, 0);">)</span><span style="color:rgb(0, 0, 0);">
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Successfully sent email&quot;</span><span style="color:rgb(0, 0, 0);">
</span><span style="color:rgb(0, 0, 136);">except</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(102, 0, 102);">Exception</span><span style="color:rgb(102, 102, 0);">:</span><span style="color:rgb(0, 0, 0);">
   </span><span style="color:rgb(0, 0, 136);">print</span><span style="color:rgb(0, 0, 0);"> </span><span style="color:rgb(0, 136, 0);">&quot;Error: unable to send email&quot;</span></pre> </div></div></div></div></div></div></div><br/></span>
</div></body></html> 